<?php
    header("Content-type:text/html;charset=utf-8");
    include_once '.phtml/apply.php';
    include_once '.phtml/common.php';
    include_once '.phtml/search.php';

    define("SINDEX",10);

    function searchBook($key){
        if($key=="") return array();
        //order by relevance
        $skey = str_replace(array("%20","%2C",".",";","%EF%BC%8C"),array("|"),$key);
        $res = exeSql("SELECT * FROM bokinfo WHERE names REGEXP '[\s\S]*($skey)[\s\S]*' or contents REGEXP '[\s\S]*($skey)[\s\S]*' or search_index REGEXP '[\s\S]*($skey)[\s\S]*'");
        $arr = array();
        while($row = mysqli_fetch_array($res,MYSQLI_ASSOC)){
            $row = findRel($row,$key);
            $rel = $row["rel"];
            if($rel<60){
                //search content
                $c = 0;
                $len = strlen($key);
                $cons = strtolower(urldecode($row["contents"]));
                for($x=0;$x<strlen($cons)-$len;$x++){
                    if(substr($cons,$x,$len)!=$key) continue;
                    $c++;
                    $x+=$len-1;
                }
                $c *= $len;
                $rel += intval($c/strlen($cons)*40);
            }
            $row["rel"] = $rel;
            array_push($arr,$row);
        }
        $aarr = searchAuthor($key);
        if(sizeof($aarr)==0||$aarr[0]["rel"]<SINDEX){
            goto skip;
        }
        $aurid = $aarr[0]["aurid"];
        $res = exeSql("SELECT * FROM bokinfo WHERE authorid='id_$aurid'");
        while($row = mysqli_fetch_array($res,MYSQLI_ASSOC)){
            $f = false;
            $fid = -1;
            for($i=0;$i<sizeof($arr);$i++){
                if($arr[$i]["bookid"]==$row["bookid"]){
                    $f = true;
                    $fid = $i;
                    break;
                }
            }
            if(!$f){
                $row["rel"] = 80;
                array_push($arr,$row);
            }else if($arr[$i]["rel"]<80){
                $arr[$i]["rel"] = 80;
            }
        }
        skip:
        $aarr = searchList($key);
        if(sizeof($aarr)==0||$aarr[0]["rel"]<SINDEX){
            goto skip2;
        }
        $bokNArr = explode(":",$aarr[0]["bookid"]);
        for($x=0;$x<sizeof($bokNArr);$x++){
            $bid = $bokNArr[$x];
            if($bid==""||strpos($bid,"id_")===false) continue;
            $id = substr($bid,3,strlen($bid));
            $res = exeSql("SELECT * FROM bokinfo WHERE bookid='$id'");
            $row = array();
            while($row = mysqli_fetch_array($res,MYSQLI_ASSOC)){
                break;
            }
            $f = false;
            $fid = -1;
            for($i=0;$i<sizeof($arr);$i++){
                if($arr[$i]["bookid"]==$row["bookid"]){
                    $f = true;
                    $fid = $i;
                    break;
                }
            }
            if(!$f){
                $row["rel"] = 80;
                array_push($arr,$row);
            }else if($arr[$i]["rel"]<80){
                $arr[$i]["rel"] = 80;
            }
        }
        skip2:
        //re-arrange by relevance
        $arr = relArrangeArr($arr);
        for($i=0;$i<sizeof($arr);$i++){
            //select first of the picpath
            $arr[$i]["picpath"] = explode(":",$arr[$i]["picpath"])[0];
        }
        return $arr;
    }

    function searchAuthor($key){
        if($key=="") return array();
        $skey = str_replace(array("%20","%2C",".",";","%EF%BC%8C"),array("|"),$key);
        $res = exeSql("SELECT * FROM aurinfo WHERE names REGEXP '[\s\S]*($skey)[\s\S]*' or search_index REGEXP '[\s\S]*($skey)[\s\S]*' or contents REGEXP '[\s\S]*($skey)[\s\S]*'");
        $arr = array();
        while($row = mysqli_fetch_array($res,MYSQLI_ASSOC)){
            //find relevance of the author
            $row = findRel($row,$key);
            $rel = $row["rel"];
            if($rel<60){
                $c = 0;
                $len = strlen($key);
                $cons = strtolower(urldecode($row["contents"]));
                for($x=0;$x<strlen($cons)-$len;$x++){
                    if(substr($cons,$x,$len)!=$key) continue;
                    $c++;
                    $x+=$len-1;
                }
                $c *= $len;
                $rel += intval($c/strlen($cons)*40);
            }
            $row["rel"] = $rel;
            array_push($arr,$row);
        }
        $arr = relArrangeArr($arr);
        for($i=0;$i<sizeof($arr);$i++){
            //select first of the picpath
            $arr[$i]["picpath"] = explode(":",$arr[$i]["picpath"])[0];
        }
        return $arr;
    }

    function searchList($key){
        //search list
        if($key=="") return array();
        $skey = str_replace(array("%20","%2C",".",";","%EF%BC%8C"),array("|"),$key);
        $res = exeSql("SELECT * FROM bklinfo WHERE names REGEXP '[\s\S]*($skey)[\s\S]*' or search_index REGEXP '[\s\S]*($skey)[\s\S]*' or contents REGEXP '[\s\S]*($skey)[\s\S]*'");
        $arr = array();
        while($row = mysqli_fetch_array($res,MYSQLI_ASSOC)){
            //find relevance of the list
            $row = findRel($row,$key);
            $rel = $row["rel"];
            if($rel<60){
                $c = 0;
                $len = strlen($key);
                $cons = strtolower(urldecode($row["contents"]));
                for($x=0;$x<strlen($cons)-$len;$x++){
                    if(substr($cons,$x,$len)!=$key) continue;
                    $c++;
                    $x+=$len-1;
                }
                $c *= $len;
                $rel += intval($c/strlen($cons)*40);
            }
            $row["rel"] = $rel;
            array_push($arr,$row);
        }
        $arr = relArrangeArr($arr);
        for($i=0;$i<sizeof($arr);$i++){
            //select first of the picpath
            $arr[$i]["picpath"] = explode(":",$arr[$i]["picpath"])[0];
        }
        return $arr;
    }

    function searchLabel($key){
        //searchBookByLabel
        if($key=="") return array();
        $skey = str_replace(array("%20","%2C",".",";","%EF%BC%8C"," "),array(""),$key);
        $res = exeSql("SELECT * FROM lblinfo WHERE URLENCODE(label_name) LIKE '%$key%'");
        $arr = array();
        while($row = mysqli_fetch_array($res,MYSQLI_ASSOC)){
            $row = findRel($row,$key);
            array_push($arr,$row);
        }
        $arr = relArrangeArr($arr);
        return $arr;
    }

    function searchLabelid($key){
        if($key=="") return array();
        $arr = array();
        $res = exeSql("SELECT * FROM bokinfo WHERE label LIKE '%id_$key%'");
        while($row=mysqli_fetch_array($res,MYSQLI_ASSOC)){
            array_push($arr,$row);
        }
        return $arr;
    }

    function searchLabelidAList($key){
        if($key=="") return array();
        $arr = array();
        $res = exeSql("SELECT * FROM bklinfo WHERE label LIKE '%id_$key%'");
        while($row=mysqli_fetch_array($res,MYSQLI_ASSOC)){
            array_push($arr,$row);
        }
        return $arr;
    }

    function searchHelp($key){

    }

    function relArrangeArr($arr){
        $newArr = array();
        for($i=0;$i<sizeof($arr);$i++){
            $max = $i;
            for($x=0;$x<sizeof($arr);$x++){
                if(intval($arr[$x]["rel"])>intval($arr[$max]["rel"])){
                    $max = $x;
                }
            }
            array_push($newArr,$arr[$max]);
            $arr[$max]["rel"] = -1;
        }
        return $newArr;
    }

    function getBokHtml($arr,$key){
        $html = "";
        for($i=0;$i<sizeof($arr);$i++){
            $bookid = $arr[$i]["bookid"];
            $picpath = $arr[$i]["picpath"];
            $names = rawurldecode($arr[$i]["names"]);
            $authors = explode(":",urldecode($arr[$i]["authorid"]));
            $labels = explode(":",urldecode($arr[$i]["label"]));
            $contents = preg_replace("#　#"," ",urldecode(textLimit2($arr[$i]["contents"],1200))) . "...";
            $key = rawurldecode($key);
            $rel = $arr[$i]["rel"];
            if(isset($arr[$i]["ultra-lang"])) $names.= " (".rawurldecode($arr[$i]["ultra-lang"]).")";
            $type = "";
            if($picpath!=""){
                $type = "image";
            }else{
                $type = "text-only";
            }
            $html .= "<div class=\"infobox\" with='$type'>";
            if($picpath!="") $html .= "<a xhr href=\"?book/$bookid\"><img src=\"Image/book/$picpath\"></a>";
            $html .= '<div class="text">';
            $html .= "<a class=\"title\" xhr href=\"?book/$bookid\">$names</a>";
            $html .= "<p>$contents...</p>";
            $html .= '<p g="">#书籍 | 作者：';
            for($x=0;$x<sizeof($authors);$x++){
                $authorid = $authors[$x];
                if(strpos($authorid,"id_")!==false){
                    $id = substr($authorid,3);
                    $res = exeSql("SELECT names FROM aurinfo WHERE aurid='$id'");
                    while($row = mysqli_fetch_array($res,MYSQLI_ASSOC)){
                        $name = urldecode($row["names"]);
                        $html .= "<a xhr href=\"?author/$id\">$name</a>";
                    }
                }else{
                    $authorid = urldecode($authorid);
                    $html .= "<a>$authorid</a>";
                }
                if($x!==sizeof($authors)-1){
                    $html .= "，";
                }
            }
            if(sizeof($labels)!=0&&$labels[0]!=""){
                $html .= "&nbsp;|&nbsp标签：";
            }
            for($x=0;$x<sizeof($labels);$x++){
                $labelid = $labels[$x];
                if(strpos($labelid,"id_")!==false){
                    $id = substr($labelid,3);
                    $res = exeSql("SELECT label_name FROM lblinfo WHERE labelid='$id'");
                    while($row = mysqli_fetch_array($res,MYSQLI_ASSOC)){
                        $name = urldecode($row["label_name"]);
                        $html .= "<a xhr href=\"?search/labelid/$id\">$name</a>";
                    }
                }else{
                    $labelid = urldecode($labelid);
                    $html .= "<a href=\"javascript:;\">$labelid</a>";
                }
                if($x!==sizeof($labels)-1){
                    $html .= "，";
                }
            }
            $html .= "</p>";
            $rel = $arr[$i]["rel"];
            $lang = generateL($bookid);
            $price = generateP($bookid);
            $eva = generateE($bookid);
            $e1 = $eva[0];
            $e2 = $eva[1];
            $html .= "<p> $lang| <span o><i class='$e1'></i><span>$e2</span></span>  | <span r>$price</span></p>";
            $html .= '</div></div>';
        }
        if($key==""){
            $html = "<div style=\"position:relative;width:auto;margin:0px auto;padding:80px 0;text-align:center\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"128\" height=\"96\" viewBox=\"0 0 1024 768\"><defs><linearGradient id=\"b\" x1=\"162.84\" gradientUnits=\"userSpaceOnUse\" x2=\"162.84\" gradientTransform=\"matrix(.70233 0 0 .6756 -3.924 6.49)\" y1=\"439.45\" y2=\"228.35\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><filter id=\"g\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"2.186\"></feGaussianBlur></filter><filter id=\"e\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.5\"></feGaussianBlur></filter><filter id=\"k\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"c\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"a\"><stop stop-color=\"#fff\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fff\" offset=\"1\"></stop></linearGradient><filter id=\"n\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"m\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"d\" y2=\"285.22\" gradientUnits=\"userSpaceOnUse\" x2=\"360.36\" y1=\"283.79\" x1=\"342.5\"><stop offset=\"0\"></stop><stop stop-color=\"#ccc\" offset=\"1\"></stop></linearGradient><linearGradient id=\"f\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68228 0 0 1.2202 967.34 -126.44)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"h\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.70022 -.06541 -.01782 .44318 984.41 235.89)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"i\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 -.15435 .00897 -.31646 979.33 599.82)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"j\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71803 .08687 -.02422 -.31389 995.29 518.54)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"l\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71264 .17918 -.0368 -.30996 999.11 486.13)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"o\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.67271 -.05464 -.01387 .40326 955.28 281.41)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"p\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68869 .084 -.02555 -.28535 967.79 538.45)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"q\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68705 -.13544 .0063 -.28793 953.07 612.49)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"r\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 .15435 .00897 .31646 970.76 250.51)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"s\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73092 .00801 -.05464 .31184 1010.7 281.9)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"t\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 989.98 251.77)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"u\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 995.87 238.35)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"v\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73086 -.01204 -.05293 -.31214 1017.3 570.96)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><radialGradient id=\"w\" gradientUnits=\"userSpaceOnUse\" cy=\"133.61\" cx=\"14.817\" gradientTransform=\"matrix(2.8644 0 0 2.343 738.15 127.24)\" r=\"40.913\"><stop stop-color=\"#f6f6aa\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#f8f8ac\" offset=\"1\"></stop></radialGradient></defs><path d=\"M335.11 255.73l663.28-80.86L334.34 291.5z\" transform=\"matrix(.68228 0 0 -1.2055 -212.275 413)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#c)\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -287.17)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -274.9)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -260.97)\" stroke=\"#000\" stroke-width=\"1.266\"></path><path d=\"M477.98 260.36L442.8 755.71l71.61 11.07 8.39-516.6z\" fill=\"#b3b3b3\" stroke=\"#b3b3b3\"></path><path d=\"M522.98 250.36l40.714 6.429 27.143 503.57-76.071 7.142z\" fill=\"#f2f2f2\" stroke=\"#f2f2f2\"></path><path d=\"M563.69 256.78l20 12.857 41.071 481.07-33.75 9.464z\" fill=\"#ececec\" stroke=\"#ececec\"></path><path d=\"M468.69 270.36l9.286-8.571-35.536 493.93-19.464-8.215z\" fill=\"#999\" stroke=\"#b3b3b3\"></path><path d=\"M536.9 494.32l26.895.126-1.515 55.432z\" fill=\"#b3b3b3\"></path><path d=\"M540.92 500.13l17.425.253.126 18.562-17.678-.127zm.05 20.93l17.425.253.126 18.562-17.678-.127zm-97.89 131.1l1.515-49.119 4.672-1.768-3.283 51.644zm15.59-199.06l1.515-49.119 4.672-1.768-3.283 51.644zm9.85-125.26l1.515-49.119 4.672-1.768-3.283 51.644z\" stroke=\"#000\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -299.45)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M567.349 188.699a41.786 13.304 0 1 1-.004-.183\"></path><path d=\"M297.95 302.54c17.309-10.51 57.09-7.151 72.143.536v-25.18c-21.019-12.346-47.757-13.053-71.786-1.606z\" fill=\"url(#d)\" stroke=\"#000\" stroke-width=\"2.2\" transform=\"translate(191.55 -84.15)\"></path><path d=\"M485.03 248.35c17.309-10.51 66.019-8.937 81.071-1.25v-25.179c-18.16-11.63-58.11-14.3-80.71-1.6z\" stroke=\"#000\"></path><path d=\"M513.07 160.21l13.036-10.714 11.964 11.071z\" stroke=\"#000\" stroke-linejoin=\"round\"></path><path d=\"M516.91 160l.357 16.071 16.43.536.535-16.25z\" stroke=\"#000\"></path><path d=\"M525.84 152.86l.893-55.179M477.09 210.18l.536 34.107M462.26 224.64l.54 34.11m125.18-37.5l-.536 37.679M565.84 207.68l-.714 38.214\" fill=\"none\" stroke=\"#000\"></path><path d=\"M538.985 160.537a13.181 4.197 0 1 1-.001-.057\"></path><path d=\"M557.73 191.91l-6.566 22.728m-7.074-1.518l-6.06-26.264\" fill=\"none\" stroke=\"#000\" stroke-width=\"2.3\"></path><path d=\"M1013.6 197.14l-658.29 84.542v14.496s662.99 98.569 658.29 93.904z\" transform=\"matrix(-.68228 0 0 1.1507 711.32 -134.302)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#e)\"></path><path d=\"M286.77 301.95l439.86 97.468v17.688l-439.86 114.58z\" opacity=\".668\" fill=\"url(#f)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1012.9 190.92l-657.59 94.611v5.7s660.74 108.96 656.04 104.29z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#g)\"></path><path d=\"M281.44 345.28l445.18 59.875v6.424l-450.25-1.9z\" opacity=\".668\" fill=\"url(#h)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M265.33 331.8l461.3 91.787v-4.588l-459.59-146.78z\" opacity=\".49\" fill=\"url(#i)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M360.24 384.45l637.23-203.31-628.3 233.59z\" transform=\"matrix(.6533 -.34756 -.19671 -1.1543 -147.12 760.92)\" opacity=\".363\" fill=\"#80ffe6\" filter=\"url(#c)\"></path><path d=\"M269.5 490.25l457.12-78.122v-4.55L266 435.896z\" opacity=\".668\" fill=\"url(#j)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1015.4 297.01l-660.09-11.053v3.268l657.64 50.226z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#k)\"></path><path d=\"M281.24 466.99l445.38-46.915v-4.493l-452.31-6.95z\" opacity=\".413\" fill=\"url(#l)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M335.11 255.73l690.19-66.12L334.34 291.5z\" transform=\"matrix(.655 -.00473 -.00882 -1.0965 -201.033 430.01)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#m)\"></path><path d=\"M1021.2 227.46l-692.97 45.145.044 3.267 690.48-5.972z\" transform=\"matrix(-.655 .00473 .00893 1.1099 681.49 -92.81)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#n)\"></path><path d=\"M281.22 385.8l445.4 37.255v5.846l-449.81 15.513z\" opacity=\".668\" fill=\"url(#o)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M281.2 403.46l445.42 22.099v-2.652l-449.18-68.864z\" opacity=\".668\" fill=\"url(#p)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M268.46 392.63l458.17 32.063v-4.174l-456.96-82.1z\" opacity=\".49\" fill=\"url(#q)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M261.2 515.57l465.42-87.279v4.588l-463.71 142.27z\" opacity=\".49\" fill=\"url(#r)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M262.43 391.94l464.19 27.007v4.52L267 453.625z\" opacity=\".49\" fill=\"url(#s)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M260.94 457.27l465.68-29.23v4.583l-468.9 84.168z\" opacity=\".49\" fill=\"url(#t)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M266.84 443.85l459.78-22.943v4.583l-463.01 77.881z\" opacity=\".49\" fill=\"url(#u)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M269.64 449.38l456.98-17.832v-4.525l-466.93-36.415z\" opacity=\".49\" fill=\"url(#v)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M897.77 440.28c0 52.925-52.449 95.838-117.16 95.854-64.709 0-117.18-42.881-117.22-95.822-.032-52.925 52.392-95.857 117.1-95.897 64.709-.04 117.21 42.828 117.28 95.753\" opacity=\".875\" fill=\"url(#w)\" transform=\"translate(-257.72 -210.44)\"></path></svg><p class=\"loss_title\">搜索关键词不能为空</p><p class=\"loss_detail\">输入关键词以搜索</p></div>";
        }else if($html==""){
            $k4 = rawurldecode($key);
            $html = "<div style=\"position:relative;width:auto;margin:0px auto;padding:80px 0;text-align:center\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"128\" height=\"96\" viewBox=\"0 0 1024 768\"><defs><linearGradient id=\"b\" x1=\"162.84\" gradientUnits=\"userSpaceOnUse\" x2=\"162.84\" gradientTransform=\"matrix(.70233 0 0 .6756 -3.924 6.49)\" y1=\"439.45\" y2=\"228.35\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><filter id=\"g\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"2.186\"></feGaussianBlur></filter><filter id=\"e\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.5\"></feGaussianBlur></filter><filter id=\"k\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"c\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"a\"><stop stop-color=\"#fff\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fff\" offset=\"1\"></stop></linearGradient><filter id=\"n\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"m\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"d\" y2=\"285.22\" gradientUnits=\"userSpaceOnUse\" x2=\"360.36\" y1=\"283.79\" x1=\"342.5\"><stop offset=\"0\"></stop><stop stop-color=\"#ccc\" offset=\"1\"></stop></linearGradient><linearGradient id=\"f\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68228 0 0 1.2202 967.34 -126.44)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"h\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.70022 -.06541 -.01782 .44318 984.41 235.89)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"i\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 -.15435 .00897 -.31646 979.33 599.82)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"j\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71803 .08687 -.02422 -.31389 995.29 518.54)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"l\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71264 .17918 -.0368 -.30996 999.11 486.13)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"o\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.67271 -.05464 -.01387 .40326 955.28 281.41)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"p\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68869 .084 -.02555 -.28535 967.79 538.45)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"q\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68705 -.13544 .0063 -.28793 953.07 612.49)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"r\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 .15435 .00897 .31646 970.76 250.51)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"s\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73092 .00801 -.05464 .31184 1010.7 281.9)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"t\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 989.98 251.77)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"u\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 995.87 238.35)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"v\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73086 -.01204 -.05293 -.31214 1017.3 570.96)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><radialGradient id=\"w\" gradientUnits=\"userSpaceOnUse\" cy=\"133.61\" cx=\"14.817\" gradientTransform=\"matrix(2.8644 0 0 2.343 738.15 127.24)\" r=\"40.913\"><stop stop-color=\"#f6f6aa\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#f8f8ac\" offset=\"1\"></stop></radialGradient></defs><path d=\"M335.11 255.73l663.28-80.86L334.34 291.5z\" transform=\"matrix(.68228 0 0 -1.2055 -212.275 413)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#c)\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -287.17)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -274.9)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -260.97)\" stroke=\"#000\" stroke-width=\"1.266\"></path><path d=\"M477.98 260.36L442.8 755.71l71.61 11.07 8.39-516.6z\" fill=\"#b3b3b3\" stroke=\"#b3b3b3\"></path><path d=\"M522.98 250.36l40.714 6.429 27.143 503.57-76.071 7.142z\" fill=\"#f2f2f2\" stroke=\"#f2f2f2\"></path><path d=\"M563.69 256.78l20 12.857 41.071 481.07-33.75 9.464z\" fill=\"#ececec\" stroke=\"#ececec\"></path><path d=\"M468.69 270.36l9.286-8.571-35.536 493.93-19.464-8.215z\" fill=\"#999\" stroke=\"#b3b3b3\"></path><path d=\"M536.9 494.32l26.895.126-1.515 55.432z\" fill=\"#b3b3b3\"></path><path d=\"M540.92 500.13l17.425.253.126 18.562-17.678-.127zm.05 20.93l17.425.253.126 18.562-17.678-.127zm-97.89 131.1l1.515-49.119 4.672-1.768-3.283 51.644zm15.59-199.06l1.515-49.119 4.672-1.768-3.283 51.644zm9.85-125.26l1.515-49.119 4.672-1.768-3.283 51.644z\" stroke=\"#000\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -299.45)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M567.349 188.699a41.786 13.304 0 1 1-.004-.183\"></path><path d=\"M297.95 302.54c17.309-10.51 57.09-7.151 72.143.536v-25.18c-21.019-12.346-47.757-13.053-71.786-1.606z\" fill=\"url(#d)\" stroke=\"#000\" stroke-width=\"2.2\" transform=\"translate(191.55 -84.15)\"></path><path d=\"M485.03 248.35c17.309-10.51 66.019-8.937 81.071-1.25v-25.179c-18.16-11.63-58.11-14.3-80.71-1.6z\" stroke=\"#000\"></path><path d=\"M513.07 160.21l13.036-10.714 11.964 11.071z\" stroke=\"#000\" stroke-linejoin=\"round\"></path><path d=\"M516.91 160l.357 16.071 16.43.536.535-16.25z\" stroke=\"#000\"></path><path d=\"M525.84 152.86l.893-55.179M477.09 210.18l.536 34.107M462.26 224.64l.54 34.11m125.18-37.5l-.536 37.679M565.84 207.68l-.714 38.214\" fill=\"none\" stroke=\"#000\"></path><path d=\"M538.985 160.537a13.181 4.197 0 1 1-.001-.057\"></path><path d=\"M557.73 191.91l-6.566 22.728m-7.074-1.518l-6.06-26.264\" fill=\"none\" stroke=\"#000\" stroke-width=\"2.3\"></path><path d=\"M1013.6 197.14l-658.29 84.542v14.496s662.99 98.569 658.29 93.904z\" transform=\"matrix(-.68228 0 0 1.1507 711.32 -134.302)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#e)\"></path><path d=\"M286.77 301.95l439.86 97.468v17.688l-439.86 114.58z\" opacity=\".668\" fill=\"url(#f)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1012.9 190.92l-657.59 94.611v5.7s660.74 108.96 656.04 104.29z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#g)\"></path><path d=\"M281.44 345.28l445.18 59.875v6.424l-450.25-1.9z\" opacity=\".668\" fill=\"url(#h)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M265.33 331.8l461.3 91.787v-4.588l-459.59-146.78z\" opacity=\".49\" fill=\"url(#i)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M360.24 384.45l637.23-203.31-628.3 233.59z\" transform=\"matrix(.6533 -.34756 -.19671 -1.1543 -147.12 760.92)\" opacity=\".363\" fill=\"#80ffe6\" filter=\"url(#c)\"></path><path d=\"M269.5 490.25l457.12-78.122v-4.55L266 435.896z\" opacity=\".668\" fill=\"url(#j)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1015.4 297.01l-660.09-11.053v3.268l657.64 50.226z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#k)\"></path><path d=\"M281.24 466.99l445.38-46.915v-4.493l-452.31-6.95z\" opacity=\".413\" fill=\"url(#l)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M335.11 255.73l690.19-66.12L334.34 291.5z\" transform=\"matrix(.655 -.00473 -.00882 -1.0965 -201.033 430.01)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#m)\"></path><path d=\"M1021.2 227.46l-692.97 45.145.044 3.267 690.48-5.972z\" transform=\"matrix(-.655 .00473 .00893 1.1099 681.49 -92.81)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#n)\"></path><path d=\"M281.22 385.8l445.4 37.255v5.846l-449.81 15.513z\" opacity=\".668\" fill=\"url(#o)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M281.2 403.46l445.42 22.099v-2.652l-449.18-68.864z\" opacity=\".668\" fill=\"url(#p)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M268.46 392.63l458.17 32.063v-4.174l-456.96-82.1z\" opacity=\".49\" fill=\"url(#q)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M261.2 515.57l465.42-87.279v4.588l-463.71 142.27z\" opacity=\".49\" fill=\"url(#r)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M262.43 391.94l464.19 27.007v4.52L267 453.625z\" opacity=\".49\" fill=\"url(#s)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M260.94 457.27l465.68-29.23v4.583l-468.9 84.168z\" opacity=\".49\" fill=\"url(#t)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M266.84 443.85l459.78-22.943v4.583l-463.01 77.881z\" opacity=\".49\" fill=\"url(#u)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M269.64 449.38l456.98-17.832v-4.525l-466.93-36.415z\" opacity=\".49\" fill=\"url(#v)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M897.77 440.28c0 52.925-52.449 95.838-117.16 95.854-64.709 0-117.18-42.881-117.22-95.822-.032-52.925 52.392-95.857 117.1-95.897 64.709-.04 117.21 42.828 117.28 95.753\" opacity=\".875\" fill=\"url(#w)\" transform=\"translate(-257.72 -210.44)\"></path></svg><p class=\"loss_title\">找不到您想要的书</p><p class=\"loss_detail\">我们的书库里没有与‘<b>$k4</b>’有关的书</p><p class=\"loss_detail\">您可以为我们的书库<a xhr href=\"?book/#edit\">添加与‘<b>$k4</b>’有关的书</a></p><p class=\"loss_detail\">没有显示搜索结果？<a xhr href=\"?help/search\" style=\"color:#0366d6;\">帮助</a></p></div>";
        }
        return $html;
    }

    function getListHtml($arr,$key){
        $html = "";
        for($i=0;$i<sizeof($arr);$i++){
            $id = $arr[$i]["bklid"];
            $picpath = $arr[$i]["picpath"];
            $names = rawurldecode($arr[$i]["names"]);
            $books = explode(":",urldecode($arr[$i]["bookid"]));
            $labels = explode(":",urldecode($arr[$i]["label"]));
            $contents = urldecode(textLimit2($arr[$i]["contents"],1200)) . "...";
            $datestr = date("Y年m月d日",$arr[$i]["date"]);
            $key = urldecode($key);
            if(isset($arr[$i]["ultra-lang"])) $names.= " (".rawurldecode($arr[$i]["ultra-lang"]).")";
            $type = "";
            if($picpath!=""){
                $type = "image";
            }else{
                $type = "text-only";
            }
            $html .= "<div class=\"infobox\" with='$type'>";
            if($picpath!="") $html .= "<a xhr href=\"?list/$id\"><img src=\"Image/list/$picpath\"></a>";
            $html .= '<div class="text">';
            $html .= "<a class=\"title\" xhr href=\"?list/$id\">$names</a>&nbsp;&nbsp;<span style='color:#54595d'>创建于$datestr</span>";
            $html .= "<p>$contents...</p>";
            $html .= '<p g="">#书单 | 包含书籍：';
            $c = 0;
            $c1 = 0;
            for($x=0;$x<sizeof($books);$x++){
                $bookid = $books[$x];
                $c++;
                if($c1>=3) continue;
                if(strpos($bookid,"id_")!==false){
                    $id = substr($bookid,3);
                    $res = exeSql("SELECT names FROM bokinfo WHERE bookid='$id'");
                    while($row = mysqli_fetch_array($res,MYSQLI_ASSOC)){
                        #change the number to modify limitation of books
                        $name = urldecode($row["names"]);
                        $html .= "<a xhr href=\"?book/$id\">$name</a>";
                        $break;
                    }
                }else{
                    $bookid = urldecode($bookid);
                    $html .= "<a>$bookid</a>";
                }
                if($x!==sizeof($books)-1){
                    $html .= "，";
                }
                $c1++;
            }
            if($c1<$c){
                $html .= "以及更多";
            }
            if(sizeof($labels)!=0&&$labels[0]!=""){
                $html .= "&nbsp;|&nbsp标签：";
            }
            for($x=0;$x<sizeof($labels);$x++){
                $labelid = $labels[$x];
                if(strpos($labelid,"id_")!==false){
                    $id = substr($labelid,3);
                    $res = exeSql("SELECT label_name FROM lblinfo WHERE labelid='$id'");
                    while($row = mysqli_fetch_array($res,MYSQLI_ASSOC)){
                        $name = urldecode($row["label_name"]);
                        $html .= "<a xhr href=\"?search/labelid/$id\">$name</a>";
                    }
                }else{
                    $labelid = urldecode($labelid);
                    $html .= "<a>$labelid</a>";
                }
                if($x!==sizeof($labels)-1){
                    $html .= "，";
                }
            }
            $html .= "</p>";
            $rel = $arr[$i]["rel"];
            $html .= '</div></div>';
        }
        if($key==""){
            $html = "<div style=\"position:relative;width:auto;margin:0px auto;padding:80px 0;text-align:center\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"128\" height=\"96\" viewBox=\"0 0 1024 768\"><defs><linearGradient id=\"b\" x1=\"162.84\" gradientUnits=\"userSpaceOnUse\" x2=\"162.84\" gradientTransform=\"matrix(.70233 0 0 .6756 -3.924 6.49)\" y1=\"439.45\" y2=\"228.35\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><filter id=\"g\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"2.186\"></feGaussianBlur></filter><filter id=\"e\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.5\"></feGaussianBlur></filter><filter id=\"k\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"c\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"a\"><stop stop-color=\"#fff\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fff\" offset=\"1\"></stop></linearGradient><filter id=\"n\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"m\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"d\" y2=\"285.22\" gradientUnits=\"userSpaceOnUse\" x2=\"360.36\" y1=\"283.79\" x1=\"342.5\"><stop offset=\"0\"></stop><stop stop-color=\"#ccc\" offset=\"1\"></stop></linearGradient><linearGradient id=\"f\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68228 0 0 1.2202 967.34 -126.44)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"h\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.70022 -.06541 -.01782 .44318 984.41 235.89)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"i\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 -.15435 .00897 -.31646 979.33 599.82)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"j\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71803 .08687 -.02422 -.31389 995.29 518.54)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"l\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71264 .17918 -.0368 -.30996 999.11 486.13)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"o\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.67271 -.05464 -.01387 .40326 955.28 281.41)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"p\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68869 .084 -.02555 -.28535 967.79 538.45)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"q\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68705 -.13544 .0063 -.28793 953.07 612.49)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"r\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 .15435 .00897 .31646 970.76 250.51)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"s\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73092 .00801 -.05464 .31184 1010.7 281.9)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"t\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 989.98 251.77)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"u\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 995.87 238.35)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"v\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73086 -.01204 -.05293 -.31214 1017.3 570.96)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><radialGradient id=\"w\" gradientUnits=\"userSpaceOnUse\" cy=\"133.61\" cx=\"14.817\" gradientTransform=\"matrix(2.8644 0 0 2.343 738.15 127.24)\" r=\"40.913\"><stop stop-color=\"#f6f6aa\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#f8f8ac\" offset=\"1\"></stop></radialGradient></defs><path d=\"M335.11 255.73l663.28-80.86L334.34 291.5z\" transform=\"matrix(.68228 0 0 -1.2055 -212.275 413)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#c)\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -287.17)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -274.9)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -260.97)\" stroke=\"#000\" stroke-width=\"1.266\"></path><path d=\"M477.98 260.36L442.8 755.71l71.61 11.07 8.39-516.6z\" fill=\"#b3b3b3\" stroke=\"#b3b3b3\"></path><path d=\"M522.98 250.36l40.714 6.429 27.143 503.57-76.071 7.142z\" fill=\"#f2f2f2\" stroke=\"#f2f2f2\"></path><path d=\"M563.69 256.78l20 12.857 41.071 481.07-33.75 9.464z\" fill=\"#ececec\" stroke=\"#ececec\"></path><path d=\"M468.69 270.36l9.286-8.571-35.536 493.93-19.464-8.215z\" fill=\"#999\" stroke=\"#b3b3b3\"></path><path d=\"M536.9 494.32l26.895.126-1.515 55.432z\" fill=\"#b3b3b3\"></path><path d=\"M540.92 500.13l17.425.253.126 18.562-17.678-.127zm.05 20.93l17.425.253.126 18.562-17.678-.127zm-97.89 131.1l1.515-49.119 4.672-1.768-3.283 51.644zm15.59-199.06l1.515-49.119 4.672-1.768-3.283 51.644zm9.85-125.26l1.515-49.119 4.672-1.768-3.283 51.644z\" stroke=\"#000\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -299.45)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M567.349 188.699a41.786 13.304 0 1 1-.004-.183\"></path><path d=\"M297.95 302.54c17.309-10.51 57.09-7.151 72.143.536v-25.18c-21.019-12.346-47.757-13.053-71.786-1.606z\" fill=\"url(#d)\" stroke=\"#000\" stroke-width=\"2.2\" transform=\"translate(191.55 -84.15)\"></path><path d=\"M485.03 248.35c17.309-10.51 66.019-8.937 81.071-1.25v-25.179c-18.16-11.63-58.11-14.3-80.71-1.6z\" stroke=\"#000\"></path><path d=\"M513.07 160.21l13.036-10.714 11.964 11.071z\" stroke=\"#000\" stroke-linejoin=\"round\"></path><path d=\"M516.91 160l.357 16.071 16.43.536.535-16.25z\" stroke=\"#000\"></path><path d=\"M525.84 152.86l.893-55.179M477.09 210.18l.536 34.107M462.26 224.64l.54 34.11m125.18-37.5l-.536 37.679M565.84 207.68l-.714 38.214\" fill=\"none\" stroke=\"#000\"></path><path d=\"M538.985 160.537a13.181 4.197 0 1 1-.001-.057\"></path><path d=\"M557.73 191.91l-6.566 22.728m-7.074-1.518l-6.06-26.264\" fill=\"none\" stroke=\"#000\" stroke-width=\"2.3\"></path><path d=\"M1013.6 197.14l-658.29 84.542v14.496s662.99 98.569 658.29 93.904z\" transform=\"matrix(-.68228 0 0 1.1507 711.32 -134.302)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#e)\"></path><path d=\"M286.77 301.95l439.86 97.468v17.688l-439.86 114.58z\" opacity=\".668\" fill=\"url(#f)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1012.9 190.92l-657.59 94.611v5.7s660.74 108.96 656.04 104.29z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#g)\"></path><path d=\"M281.44 345.28l445.18 59.875v6.424l-450.25-1.9z\" opacity=\".668\" fill=\"url(#h)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M265.33 331.8l461.3 91.787v-4.588l-459.59-146.78z\" opacity=\".49\" fill=\"url(#i)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M360.24 384.45l637.23-203.31-628.3 233.59z\" transform=\"matrix(.6533 -.34756 -.19671 -1.1543 -147.12 760.92)\" opacity=\".363\" fill=\"#80ffe6\" filter=\"url(#c)\"></path><path d=\"M269.5 490.25l457.12-78.122v-4.55L266 435.896z\" opacity=\".668\" fill=\"url(#j)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1015.4 297.01l-660.09-11.053v3.268l657.64 50.226z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#k)\"></path><path d=\"M281.24 466.99l445.38-46.915v-4.493l-452.31-6.95z\" opacity=\".413\" fill=\"url(#l)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M335.11 255.73l690.19-66.12L334.34 291.5z\" transform=\"matrix(.655 -.00473 -.00882 -1.0965 -201.033 430.01)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#m)\"></path><path d=\"M1021.2 227.46l-692.97 45.145.044 3.267 690.48-5.972z\" transform=\"matrix(-.655 .00473 .00893 1.1099 681.49 -92.81)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#n)\"></path><path d=\"M281.22 385.8l445.4 37.255v5.846l-449.81 15.513z\" opacity=\".668\" fill=\"url(#o)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M281.2 403.46l445.42 22.099v-2.652l-449.18-68.864z\" opacity=\".668\" fill=\"url(#p)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M268.46 392.63l458.17 32.063v-4.174l-456.96-82.1z\" opacity=\".49\" fill=\"url(#q)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M261.2 515.57l465.42-87.279v4.588l-463.71 142.27z\" opacity=\".49\" fill=\"url(#r)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M262.43 391.94l464.19 27.007v4.52L267 453.625z\" opacity=\".49\" fill=\"url(#s)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M260.94 457.27l465.68-29.23v4.583l-468.9 84.168z\" opacity=\".49\" fill=\"url(#t)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M266.84 443.85l459.78-22.943v4.583l-463.01 77.881z\" opacity=\".49\" fill=\"url(#u)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M269.64 449.38l456.98-17.832v-4.525l-466.93-36.415z\" opacity=\".49\" fill=\"url(#v)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M897.77 440.28c0 52.925-52.449 95.838-117.16 95.854-64.709 0-117.18-42.881-117.22-95.822-.032-52.925 52.392-95.857 117.1-95.897 64.709-.04 117.21 42.828 117.28 95.753\" opacity=\".875\" fill=\"url(#w)\" transform=\"translate(-257.72 -210.44)\"></path></svg><p class=\"loss_title\">搜索关键词不能为空</p><p class=\"loss_detail\">输入关键词以搜索</p></div>";
        }else if($html==""){
            $k4 = rawurldecode($key);
            $html = "<div style=\"position:relative;width:auto;margin:0px auto;padding:80px 0;text-align:center\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"128\" height=\"96\" viewBox=\"0 0 1024 768\"><defs><linearGradient id=\"b\" x1=\"162.84\" gradientUnits=\"userSpaceOnUse\" x2=\"162.84\" gradientTransform=\"matrix(.70233 0 0 .6756 -3.924 6.49)\" y1=\"439.45\" y2=\"228.35\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><filter id=\"g\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"2.186\"></feGaussianBlur></filter><filter id=\"e\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.5\"></feGaussianBlur></filter><filter id=\"k\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"c\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"a\"><stop stop-color=\"#fff\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fff\" offset=\"1\"></stop></linearGradient><filter id=\"n\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"m\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"d\" y2=\"285.22\" gradientUnits=\"userSpaceOnUse\" x2=\"360.36\" y1=\"283.79\" x1=\"342.5\"><stop offset=\"0\"></stop><stop stop-color=\"#ccc\" offset=\"1\"></stop></linearGradient><linearGradient id=\"f\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68228 0 0 1.2202 967.34 -126.44)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"h\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.70022 -.06541 -.01782 .44318 984.41 235.89)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"i\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 -.15435 .00897 -.31646 979.33 599.82)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"j\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71803 .08687 -.02422 -.31389 995.29 518.54)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"l\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71264 .17918 -.0368 -.30996 999.11 486.13)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"o\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.67271 -.05464 -.01387 .40326 955.28 281.41)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"p\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68869 .084 -.02555 -.28535 967.79 538.45)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"q\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68705 -.13544 .0063 -.28793 953.07 612.49)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"r\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 .15435 .00897 .31646 970.76 250.51)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"s\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73092 .00801 -.05464 .31184 1010.7 281.9)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"t\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 989.98 251.77)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"u\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 995.87 238.35)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"v\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73086 -.01204 -.05293 -.31214 1017.3 570.96)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><radialGradient id=\"w\" gradientUnits=\"userSpaceOnUse\" cy=\"133.61\" cx=\"14.817\" gradientTransform=\"matrix(2.8644 0 0 2.343 738.15 127.24)\" r=\"40.913\"><stop stop-color=\"#f6f6aa\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#f8f8ac\" offset=\"1\"></stop></radialGradient></defs><path d=\"M335.11 255.73l663.28-80.86L334.34 291.5z\" transform=\"matrix(.68228 0 0 -1.2055 -212.275 413)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#c)\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -287.17)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -274.9)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -260.97)\" stroke=\"#000\" stroke-width=\"1.266\"></path><path d=\"M477.98 260.36L442.8 755.71l71.61 11.07 8.39-516.6z\" fill=\"#b3b3b3\" stroke=\"#b3b3b3\"></path><path d=\"M522.98 250.36l40.714 6.429 27.143 503.57-76.071 7.142z\" fill=\"#f2f2f2\" stroke=\"#f2f2f2\"></path><path d=\"M563.69 256.78l20 12.857 41.071 481.07-33.75 9.464z\" fill=\"#ececec\" stroke=\"#ececec\"></path><path d=\"M468.69 270.36l9.286-8.571-35.536 493.93-19.464-8.215z\" fill=\"#999\" stroke=\"#b3b3b3\"></path><path d=\"M536.9 494.32l26.895.126-1.515 55.432z\" fill=\"#b3b3b3\"></path><path d=\"M540.92 500.13l17.425.253.126 18.562-17.678-.127zm.05 20.93l17.425.253.126 18.562-17.678-.127zm-97.89 131.1l1.515-49.119 4.672-1.768-3.283 51.644zm15.59-199.06l1.515-49.119 4.672-1.768-3.283 51.644zm9.85-125.26l1.515-49.119 4.672-1.768-3.283 51.644z\" stroke=\"#000\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -299.45)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M567.349 188.699a41.786 13.304 0 1 1-.004-.183\"></path><path d=\"M297.95 302.54c17.309-10.51 57.09-7.151 72.143.536v-25.18c-21.019-12.346-47.757-13.053-71.786-1.606z\" fill=\"url(#d)\" stroke=\"#000\" stroke-width=\"2.2\" transform=\"translate(191.55 -84.15)\"></path><path d=\"M485.03 248.35c17.309-10.51 66.019-8.937 81.071-1.25v-25.179c-18.16-11.63-58.11-14.3-80.71-1.6z\" stroke=\"#000\"></path><path d=\"M513.07 160.21l13.036-10.714 11.964 11.071z\" stroke=\"#000\" stroke-linejoin=\"round\"></path><path d=\"M516.91 160l.357 16.071 16.43.536.535-16.25z\" stroke=\"#000\"></path><path d=\"M525.84 152.86l.893-55.179M477.09 210.18l.536 34.107M462.26 224.64l.54 34.11m125.18-37.5l-.536 37.679M565.84 207.68l-.714 38.214\" fill=\"none\" stroke=\"#000\"></path><path d=\"M538.985 160.537a13.181 4.197 0 1 1-.001-.057\"></path><path d=\"M557.73 191.91l-6.566 22.728m-7.074-1.518l-6.06-26.264\" fill=\"none\" stroke=\"#000\" stroke-width=\"2.3\"></path><path d=\"M1013.6 197.14l-658.29 84.542v14.496s662.99 98.569 658.29 93.904z\" transform=\"matrix(-.68228 0 0 1.1507 711.32 -134.302)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#e)\"></path><path d=\"M286.77 301.95l439.86 97.468v17.688l-439.86 114.58z\" opacity=\".668\" fill=\"url(#f)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1012.9 190.92l-657.59 94.611v5.7s660.74 108.96 656.04 104.29z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#g)\"></path><path d=\"M281.44 345.28l445.18 59.875v6.424l-450.25-1.9z\" opacity=\".668\" fill=\"url(#h)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M265.33 331.8l461.3 91.787v-4.588l-459.59-146.78z\" opacity=\".49\" fill=\"url(#i)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M360.24 384.45l637.23-203.31-628.3 233.59z\" transform=\"matrix(.6533 -.34756 -.19671 -1.1543 -147.12 760.92)\" opacity=\".363\" fill=\"#80ffe6\" filter=\"url(#c)\"></path><path d=\"M269.5 490.25l457.12-78.122v-4.55L266 435.896z\" opacity=\".668\" fill=\"url(#j)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1015.4 297.01l-660.09-11.053v3.268l657.64 50.226z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#k)\"></path><path d=\"M281.24 466.99l445.38-46.915v-4.493l-452.31-6.95z\" opacity=\".413\" fill=\"url(#l)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M335.11 255.73l690.19-66.12L334.34 291.5z\" transform=\"matrix(.655 -.00473 -.00882 -1.0965 -201.033 430.01)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#m)\"></path><path d=\"M1021.2 227.46l-692.97 45.145.044 3.267 690.48-5.972z\" transform=\"matrix(-.655 .00473 .00893 1.1099 681.49 -92.81)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#n)\"></path><path d=\"M281.22 385.8l445.4 37.255v5.846l-449.81 15.513z\" opacity=\".668\" fill=\"url(#o)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M281.2 403.46l445.42 22.099v-2.652l-449.18-68.864z\" opacity=\".668\" fill=\"url(#p)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M268.46 392.63l458.17 32.063v-4.174l-456.96-82.1z\" opacity=\".49\" fill=\"url(#q)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M261.2 515.57l465.42-87.279v4.588l-463.71 142.27z\" opacity=\".49\" fill=\"url(#r)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M262.43 391.94l464.19 27.007v4.52L267 453.625z\" opacity=\".49\" fill=\"url(#s)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M260.94 457.27l465.68-29.23v4.583l-468.9 84.168z\" opacity=\".49\" fill=\"url(#t)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M266.84 443.85l459.78-22.943v4.583l-463.01 77.881z\" opacity=\".49\" fill=\"url(#u)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M269.64 449.38l456.98-17.832v-4.525l-466.93-36.415z\" opacity=\".49\" fill=\"url(#v)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M897.77 440.28c0 52.925-52.449 95.838-117.16 95.854-64.709 0-117.18-42.881-117.22-95.822-.032-52.925 52.392-95.857 117.1-95.897 64.709-.04 117.21 42.828 117.28 95.753\" opacity=\".875\" fill=\"url(#w)\" transform=\"translate(-257.72 -210.44)\"></path></svg><p class=\"loss_title\">找不到您想要的书单</p><p class=\"loss_detail\">我们的资料库里没有与‘<b>$k4</b>’有关的书单</p><p class=\"loss_detail\">您可以为我们的资料库<a xhr href=\"?list/#edit\">添加与‘<b>$k4</b>’有关的书单</a></p><p class=\"loss_detail\">没有显示搜索结果？<a xhr href=\"?help/search\" style=\"color:#0366d6;\">帮助</a></p></div>";
        }
        return $html;
    }

    function getAurHtml($arr,$key){
        $html = "";
        for($i=0;$i<sizeof($arr);$i++){
            $picpath = $arr[$i]["picpath"];
            $names = rawurldecode($arr[$i]["names"]);
            if(isset($arr[$i]["ultra-lang"])) $names.= " (".rawurldecode($arr[$i]["ultra-lang"]).")";
            $html_type = $picpath==""?"text-only":"image";
            $id = $arr[$i]["aurid"];
            $contents = urldecode(textLimit2($arr[$i]["contents"],1200)) . "...";
            $pichtml = "<a class=\"circle\" xhr href=\"?author/$id\"><img src=\"Image/author/$picpath\"></a>";
            $res = exeSql("SELECT names,bookid FROM bokinfo WHERE authorid LIKE '%id_$id%'");
            $aurbok = "";
            $c = 0;
            $c1 = 0;
            while($row = mysqli_fetch_array($res,MYSQLI_ASSOC)){
                $c++;
                #change the number to modify limitation of books
                if($c1>=3) continue;
                $bid = $row["bookid"];
                $nm = urldecode($row["names"]);
                $aurbok .= "<a xhr href=\"?book/$bid\">$nm</a>，";
                $c1++;
            }
            if($aurbok!=""){
                $aurbok = " | 作家作品：".substr($aurbok,0,strlen($aurbok)-3);
                if($c1<$c){
                    $aurbok.="，以及更多";
                }
            }
            $rel = $arr[$i]["rel"];
            $html .= "<div class=\"infobox\" with=\"$html_type\">$pichtml<div class=\"text\">
            <a class=\"title\" xhr href=\"?author/$id\">$names</a>
            <p>$contents</p><p g>#作者$aurbok</p></div></div>";
        }
        if($key==""){
            $html = "<div style=\"position:relative;width:auto;margin:0px auto;padding:80px 0;text-align:center\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"128\" height=\"96\" viewBox=\"0 0 1024 768\"><defs><linearGradient id=\"b\" x1=\"162.84\" gradientUnits=\"userSpaceOnUse\" x2=\"162.84\" gradientTransform=\"matrix(.70233 0 0 .6756 -3.924 6.49)\" y1=\"439.45\" y2=\"228.35\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><filter id=\"g\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"2.186\"></feGaussianBlur></filter><filter id=\"e\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.5\"></feGaussianBlur></filter><filter id=\"k\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"c\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"a\"><stop stop-color=\"#fff\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fff\" offset=\"1\"></stop></linearGradient><filter id=\"n\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"m\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"d\" y2=\"285.22\" gradientUnits=\"userSpaceOnUse\" x2=\"360.36\" y1=\"283.79\" x1=\"342.5\"><stop offset=\"0\"></stop><stop stop-color=\"#ccc\" offset=\"1\"></stop></linearGradient><linearGradient id=\"f\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68228 0 0 1.2202 967.34 -126.44)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"h\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.70022 -.06541 -.01782 .44318 984.41 235.89)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"i\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 -.15435 .00897 -.31646 979.33 599.82)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"j\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71803 .08687 -.02422 -.31389 995.29 518.54)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"l\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71264 .17918 -.0368 -.30996 999.11 486.13)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"o\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.67271 -.05464 -.01387 .40326 955.28 281.41)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"p\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68869 .084 -.02555 -.28535 967.79 538.45)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"q\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68705 -.13544 .0063 -.28793 953.07 612.49)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"r\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 .15435 .00897 .31646 970.76 250.51)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"s\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73092 .00801 -.05464 .31184 1010.7 281.9)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"t\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 989.98 251.77)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"u\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 995.87 238.35)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"v\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73086 -.01204 -.05293 -.31214 1017.3 570.96)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><radialGradient id=\"w\" gradientUnits=\"userSpaceOnUse\" cy=\"133.61\" cx=\"14.817\" gradientTransform=\"matrix(2.8644 0 0 2.343 738.15 127.24)\" r=\"40.913\"><stop stop-color=\"#f6f6aa\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#f8f8ac\" offset=\"1\"></stop></radialGradient></defs><path d=\"M335.11 255.73l663.28-80.86L334.34 291.5z\" transform=\"matrix(.68228 0 0 -1.2055 -212.275 413)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#c)\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -287.17)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -274.9)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -260.97)\" stroke=\"#000\" stroke-width=\"1.266\"></path><path d=\"M477.98 260.36L442.8 755.71l71.61 11.07 8.39-516.6z\" fill=\"#b3b3b3\" stroke=\"#b3b3b3\"></path><path d=\"M522.98 250.36l40.714 6.429 27.143 503.57-76.071 7.142z\" fill=\"#f2f2f2\" stroke=\"#f2f2f2\"></path><path d=\"M563.69 256.78l20 12.857 41.071 481.07-33.75 9.464z\" fill=\"#ececec\" stroke=\"#ececec\"></path><path d=\"M468.69 270.36l9.286-8.571-35.536 493.93-19.464-8.215z\" fill=\"#999\" stroke=\"#b3b3b3\"></path><path d=\"M536.9 494.32l26.895.126-1.515 55.432z\" fill=\"#b3b3b3\"></path><path d=\"M540.92 500.13l17.425.253.126 18.562-17.678-.127zm.05 20.93l17.425.253.126 18.562-17.678-.127zm-97.89 131.1l1.515-49.119 4.672-1.768-3.283 51.644zm15.59-199.06l1.515-49.119 4.672-1.768-3.283 51.644zm9.85-125.26l1.515-49.119 4.672-1.768-3.283 51.644z\" stroke=\"#000\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -299.45)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M567.349 188.699a41.786 13.304 0 1 1-.004-.183\"></path><path d=\"M297.95 302.54c17.309-10.51 57.09-7.151 72.143.536v-25.18c-21.019-12.346-47.757-13.053-71.786-1.606z\" fill=\"url(#d)\" stroke=\"#000\" stroke-width=\"2.2\" transform=\"translate(191.55 -84.15)\"></path><path d=\"M485.03 248.35c17.309-10.51 66.019-8.937 81.071-1.25v-25.179c-18.16-11.63-58.11-14.3-80.71-1.6z\" stroke=\"#000\"></path><path d=\"M513.07 160.21l13.036-10.714 11.964 11.071z\" stroke=\"#000\" stroke-linejoin=\"round\"></path><path d=\"M516.91 160l.357 16.071 16.43.536.535-16.25z\" stroke=\"#000\"></path><path d=\"M525.84 152.86l.893-55.179M477.09 210.18l.536 34.107M462.26 224.64l.54 34.11m125.18-37.5l-.536 37.679M565.84 207.68l-.714 38.214\" fill=\"none\" stroke=\"#000\"></path><path d=\"M538.985 160.537a13.181 4.197 0 1 1-.001-.057\"></path><path d=\"M557.73 191.91l-6.566 22.728m-7.074-1.518l-6.06-26.264\" fill=\"none\" stroke=\"#000\" stroke-width=\"2.3\"></path><path d=\"M1013.6 197.14l-658.29 84.542v14.496s662.99 98.569 658.29 93.904z\" transform=\"matrix(-.68228 0 0 1.1507 711.32 -134.302)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#e)\"></path><path d=\"M286.77 301.95l439.86 97.468v17.688l-439.86 114.58z\" opacity=\".668\" fill=\"url(#f)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1012.9 190.92l-657.59 94.611v5.7s660.74 108.96 656.04 104.29z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#g)\"></path><path d=\"M281.44 345.28l445.18 59.875v6.424l-450.25-1.9z\" opacity=\".668\" fill=\"url(#h)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M265.33 331.8l461.3 91.787v-4.588l-459.59-146.78z\" opacity=\".49\" fill=\"url(#i)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M360.24 384.45l637.23-203.31-628.3 233.59z\" transform=\"matrix(.6533 -.34756 -.19671 -1.1543 -147.12 760.92)\" opacity=\".363\" fill=\"#80ffe6\" filter=\"url(#c)\"></path><path d=\"M269.5 490.25l457.12-78.122v-4.55L266 435.896z\" opacity=\".668\" fill=\"url(#j)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1015.4 297.01l-660.09-11.053v3.268l657.64 50.226z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#k)\"></path><path d=\"M281.24 466.99l445.38-46.915v-4.493l-452.31-6.95z\" opacity=\".413\" fill=\"url(#l)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M335.11 255.73l690.19-66.12L334.34 291.5z\" transform=\"matrix(.655 -.00473 -.00882 -1.0965 -201.033 430.01)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#m)\"></path><path d=\"M1021.2 227.46l-692.97 45.145.044 3.267 690.48-5.972z\" transform=\"matrix(-.655 .00473 .00893 1.1099 681.49 -92.81)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#n)\"></path><path d=\"M281.22 385.8l445.4 37.255v5.846l-449.81 15.513z\" opacity=\".668\" fill=\"url(#o)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M281.2 403.46l445.42 22.099v-2.652l-449.18-68.864z\" opacity=\".668\" fill=\"url(#p)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M268.46 392.63l458.17 32.063v-4.174l-456.96-82.1z\" opacity=\".49\" fill=\"url(#q)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M261.2 515.57l465.42-87.279v4.588l-463.71 142.27z\" opacity=\".49\" fill=\"url(#r)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M262.43 391.94l464.19 27.007v4.52L267 453.625z\" opacity=\".49\" fill=\"url(#s)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M260.94 457.27l465.68-29.23v4.583l-468.9 84.168z\" opacity=\".49\" fill=\"url(#t)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M266.84 443.85l459.78-22.943v4.583l-463.01 77.881z\" opacity=\".49\" fill=\"url(#u)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M269.64 449.38l456.98-17.832v-4.525l-466.93-36.415z\" opacity=\".49\" fill=\"url(#v)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M897.77 440.28c0 52.925-52.449 95.838-117.16 95.854-64.709 0-117.18-42.881-117.22-95.822-.032-52.925 52.392-95.857 117.1-95.897 64.709-.04 117.21 42.828 117.28 95.753\" opacity=\".875\" fill=\"url(#w)\" transform=\"translate(-257.72 -210.44)\"></path></svg><p class=\"loss_title\">搜索关键词不能为空</p><p class=\"loss_detail\">输入关键词以搜索</p></div>";
        }else if($html==""){
            $k4 = rawurldecode($key);
            $html = "<div style=\"position:relative;width:auto;margin:0px auto;padding:80px 0;text-align:center\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"128\" height=\"96\" viewBox=\"0 0 1024 768\"><defs><linearGradient id=\"b\" x1=\"162.84\" gradientUnits=\"userSpaceOnUse\" x2=\"162.84\" gradientTransform=\"matrix(.70233 0 0 .6756 -3.924 6.49)\" y1=\"439.45\" y2=\"228.35\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><filter id=\"g\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"2.186\"></feGaussianBlur></filter><filter id=\"e\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.5\"></feGaussianBlur></filter><filter id=\"k\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"c\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"a\"><stop stop-color=\"#fff\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fff\" offset=\"1\"></stop></linearGradient><filter id=\"n\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"m\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"d\" y2=\"285.22\" gradientUnits=\"userSpaceOnUse\" x2=\"360.36\" y1=\"283.79\" x1=\"342.5\"><stop offset=\"0\"></stop><stop stop-color=\"#ccc\" offset=\"1\"></stop></linearGradient><linearGradient id=\"f\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68228 0 0 1.2202 967.34 -126.44)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"h\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.70022 -.06541 -.01782 .44318 984.41 235.89)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"i\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 -.15435 .00897 -.31646 979.33 599.82)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"j\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71803 .08687 -.02422 -.31389 995.29 518.54)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"l\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71264 .17918 -.0368 -.30996 999.11 486.13)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"o\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.67271 -.05464 -.01387 .40326 955.28 281.41)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"p\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68869 .084 -.02555 -.28535 967.79 538.45)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"q\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68705 -.13544 .0063 -.28793 953.07 612.49)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"r\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 .15435 .00897 .31646 970.76 250.51)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"s\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73092 .00801 -.05464 .31184 1010.7 281.9)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"t\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 989.98 251.77)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"u\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 995.87 238.35)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"v\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73086 -.01204 -.05293 -.31214 1017.3 570.96)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><radialGradient id=\"w\" gradientUnits=\"userSpaceOnUse\" cy=\"133.61\" cx=\"14.817\" gradientTransform=\"matrix(2.8644 0 0 2.343 738.15 127.24)\" r=\"40.913\"><stop stop-color=\"#f6f6aa\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#f8f8ac\" offset=\"1\"></stop></radialGradient></defs><path d=\"M335.11 255.73l663.28-80.86L334.34 291.5z\" transform=\"matrix(.68228 0 0 -1.2055 -212.275 413)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#c)\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -287.17)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -274.9)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -260.97)\" stroke=\"#000\" stroke-width=\"1.266\"></path><path d=\"M477.98 260.36L442.8 755.71l71.61 11.07 8.39-516.6z\" fill=\"#b3b3b3\" stroke=\"#b3b3b3\"></path><path d=\"M522.98 250.36l40.714 6.429 27.143 503.57-76.071 7.142z\" fill=\"#f2f2f2\" stroke=\"#f2f2f2\"></path><path d=\"M563.69 256.78l20 12.857 41.071 481.07-33.75 9.464z\" fill=\"#ececec\" stroke=\"#ececec\"></path><path d=\"M468.69 270.36l9.286-8.571-35.536 493.93-19.464-8.215z\" fill=\"#999\" stroke=\"#b3b3b3\"></path><path d=\"M536.9 494.32l26.895.126-1.515 55.432z\" fill=\"#b3b3b3\"></path><path d=\"M540.92 500.13l17.425.253.126 18.562-17.678-.127zm.05 20.93l17.425.253.126 18.562-17.678-.127zm-97.89 131.1l1.515-49.119 4.672-1.768-3.283 51.644zm15.59-199.06l1.515-49.119 4.672-1.768-3.283 51.644zm9.85-125.26l1.515-49.119 4.672-1.768-3.283 51.644z\" stroke=\"#000\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -299.45)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M567.349 188.699a41.786 13.304 0 1 1-.004-.183\"></path><path d=\"M297.95 302.54c17.309-10.51 57.09-7.151 72.143.536v-25.18c-21.019-12.346-47.757-13.053-71.786-1.606z\" fill=\"url(#d)\" stroke=\"#000\" stroke-width=\"2.2\" transform=\"translate(191.55 -84.15)\"></path><path d=\"M485.03 248.35c17.309-10.51 66.019-8.937 81.071-1.25v-25.179c-18.16-11.63-58.11-14.3-80.71-1.6z\" stroke=\"#000\"></path><path d=\"M513.07 160.21l13.036-10.714 11.964 11.071z\" stroke=\"#000\" stroke-linejoin=\"round\"></path><path d=\"M516.91 160l.357 16.071 16.43.536.535-16.25z\" stroke=\"#000\"></path><path d=\"M525.84 152.86l.893-55.179M477.09 210.18l.536 34.107M462.26 224.64l.54 34.11m125.18-37.5l-.536 37.679M565.84 207.68l-.714 38.214\" fill=\"none\" stroke=\"#000\"></path><path d=\"M538.985 160.537a13.181 4.197 0 1 1-.001-.057\"></path><path d=\"M557.73 191.91l-6.566 22.728m-7.074-1.518l-6.06-26.264\" fill=\"none\" stroke=\"#000\" stroke-width=\"2.3\"></path><path d=\"M1013.6 197.14l-658.29 84.542v14.496s662.99 98.569 658.29 93.904z\" transform=\"matrix(-.68228 0 0 1.1507 711.32 -134.302)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#e)\"></path><path d=\"M286.77 301.95l439.86 97.468v17.688l-439.86 114.58z\" opacity=\".668\" fill=\"url(#f)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1012.9 190.92l-657.59 94.611v5.7s660.74 108.96 656.04 104.29z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#g)\"></path><path d=\"M281.44 345.28l445.18 59.875v6.424l-450.25-1.9z\" opacity=\".668\" fill=\"url(#h)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M265.33 331.8l461.3 91.787v-4.588l-459.59-146.78z\" opacity=\".49\" fill=\"url(#i)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M360.24 384.45l637.23-203.31-628.3 233.59z\" transform=\"matrix(.6533 -.34756 -.19671 -1.1543 -147.12 760.92)\" opacity=\".363\" fill=\"#80ffe6\" filter=\"url(#c)\"></path><path d=\"M269.5 490.25l457.12-78.122v-4.55L266 435.896z\" opacity=\".668\" fill=\"url(#j)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1015.4 297.01l-660.09-11.053v3.268l657.64 50.226z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#k)\"></path><path d=\"M281.24 466.99l445.38-46.915v-4.493l-452.31-6.95z\" opacity=\".413\" fill=\"url(#l)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M335.11 255.73l690.19-66.12L334.34 291.5z\" transform=\"matrix(.655 -.00473 -.00882 -1.0965 -201.033 430.01)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#m)\"></path><path d=\"M1021.2 227.46l-692.97 45.145.044 3.267 690.48-5.972z\" transform=\"matrix(-.655 .00473 .00893 1.1099 681.49 -92.81)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#n)\"></path><path d=\"M281.22 385.8l445.4 37.255v5.846l-449.81 15.513z\" opacity=\".668\" fill=\"url(#o)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M281.2 403.46l445.42 22.099v-2.652l-449.18-68.864z\" opacity=\".668\" fill=\"url(#p)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M268.46 392.63l458.17 32.063v-4.174l-456.96-82.1z\" opacity=\".49\" fill=\"url(#q)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M261.2 515.57l465.42-87.279v4.588l-463.71 142.27z\" opacity=\".49\" fill=\"url(#r)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M262.43 391.94l464.19 27.007v4.52L267 453.625z\" opacity=\".49\" fill=\"url(#s)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M260.94 457.27l465.68-29.23v4.583l-468.9 84.168z\" opacity=\".49\" fill=\"url(#t)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M266.84 443.85l459.78-22.943v4.583l-463.01 77.881z\" opacity=\".49\" fill=\"url(#u)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M269.64 449.38l456.98-17.832v-4.525l-466.93-36.415z\" opacity=\".49\" fill=\"url(#v)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M897.77 440.28c0 52.925-52.449 95.838-117.16 95.854-64.709 0-117.18-42.881-117.22-95.822-.032-52.925 52.392-95.857 117.1-95.897 64.709-.04 117.21 42.828 117.28 95.753\" opacity=\".875\" fill=\"url(#w)\" transform=\"translate(-257.72 -210.44)\"></path></svg><p class=\"loss_title\">找不到您想要的作者</p><p class=\"loss_detail\">我们的资料库里没有与‘<b>$k4</b>’有关的作者</p><p class=\"loss_detail\">您可以为我们的资料库<a xhr href=\"?author/#edit\">添加与‘<b>$k4</b>’有关的作者</a></p><p class=\"loss_detail\">没有显示搜索结果？<a xhr href=\"?help/search\" style=\"color:#0366d6;\">帮助</a></p></div>";
        }
        return $html;
    }

    function getLabelidHtml($arr,$key){
        $html = "";
        for($i=0;$i<sizeof($arr);$i++){
            $id = $arr[$i]["bookid"];
            $picpath = isset(explode(":",$arr[$i]["picpath"])[0])?explode(":",$arr[$i]["picpath"])[0]:"";
            $names = rawurldecode($arr[$i]["names"]);
            $authors = explode(":",urldecode($arr[$i]["authorid"]));
            $labels = explode(":",urldecode($arr[$i]["label"]));
            $contents = preg_replace("#　#","",urldecode(textLimit2($arr[$i]["contents"],1200))) . "...";
            $key = rawurldecode($key);
            if(isset($arr[$i]["ultra-lang"])) $names.= " (".rawurldecode($arr[$i]["ultra-lang"]).")";
            $type = "";
            if($picpath!=""){
                $type = "image";
            }else{
                $type = "text-only";
            }
            $html .= "<div class=\"infobox\" with='$type'>";
            if($picpath!="") $html .= "<a xhr href=\"?book/$id\"><img src=\"Image/book/$picpath\"></a>";
            $html .= '<div class="text">';
            $html .= "<a class=\"title\" xhr href=\"?book/$id\">$names</a>";
            $html .= "<p>$contents...</p>";
            $html .= '<p g="">#书籍 | 作者：';
            for($x=0;$x<sizeof($authors);$x++){
                $authorid = $authors[$x];
                if(strpos($authorid,"id_")!==false){
                    $id = substr($authorid,3);
                    $res = exeSql("SELECT names FROM aurinfo WHERE aurid='$id'");
                    while($row = mysqli_fetch_array($res,MYSQLI_ASSOC)){
                        $name = urldecode($row["names"]);
                        $html .= "<a xhr href=\"?author/$id\">$name</a>";
                    }
                }else{
                    $authorid = urldecode($authorid);
                    $html .= "<a>$authorid</a>";
                }
                if($x!==sizeof($authors)-1){
                    $html .= "，";
                }
            }
            if(sizeof($labels)!=0&&$labels[0]!=""){
                $html .= "&nbsp;|&nbsp标签：";
            }
            for($x=0;$x<sizeof($labels);$x++){
                $labelid = $labels[$x];
                if(strpos($labelid,"id_")!==false){
                    $id = substr($labelid,3);
                    $res = exeSql("SELECT label_name FROM lblinfo WHERE labelid='$id'");
                    while($row = mysqli_fetch_array($res,MYSQLI_ASSOC)){
                        $name = urldecode($row["label_name"]);
                        $html .= "<a xhr href=\"?search/labelid/$id\">$name</a>";
                    }
                }else{
                    $labelid = urldecode($labelid);
                    $html .= "<a href=\"javascript:;\">$labelid</a>";
                }
                if($x!==sizeof($labels)-1){
                    $html .= "，";
                }
            }
            $html .= "</p>";
            $bookid = $id;
            $lang = generateL($bookid);
            $price = generateP($bookid);
            $eva = generateE($bookid);
            $e1 = $eva[0];
            $e2 = $eva[1];
            $html .= "<p> $lang| <span o><i class='$e1'></i><span>$e2</span></span>  | <span r>$price</span></p>";
            $html .= '</div></div>';
        }
        if($key==""){
            $html = "<div style=\"position:relative;width:auto;margin:0px auto;padding:80px 0;text-align:center\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"128\" height=\"96\" viewBox=\"0 0 1024 768\"><defs><linearGradient id=\"b\" x1=\"162.84\" gradientUnits=\"userSpaceOnUse\" x2=\"162.84\" gradientTransform=\"matrix(.70233 0 0 .6756 -3.924 6.49)\" y1=\"439.45\" y2=\"228.35\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><filter id=\"g\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"2.186\"></feGaussianBlur></filter><filter id=\"e\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.5\"></feGaussianBlur></filter><filter id=\"k\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"c\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"a\"><stop stop-color=\"#fff\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fff\" offset=\"1\"></stop></linearGradient><filter id=\"n\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"m\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"d\" y2=\"285.22\" gradientUnits=\"userSpaceOnUse\" x2=\"360.36\" y1=\"283.79\" x1=\"342.5\"><stop offset=\"0\"></stop><stop stop-color=\"#ccc\" offset=\"1\"></stop></linearGradient><linearGradient id=\"f\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68228 0 0 1.2202 967.34 -126.44)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"h\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.70022 -.06541 -.01782 .44318 984.41 235.89)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"i\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 -.15435 .00897 -.31646 979.33 599.82)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"j\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71803 .08687 -.02422 -.31389 995.29 518.54)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"l\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71264 .17918 -.0368 -.30996 999.11 486.13)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"o\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.67271 -.05464 -.01387 .40326 955.28 281.41)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"p\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68869 .084 -.02555 -.28535 967.79 538.45)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"q\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68705 -.13544 .0063 -.28793 953.07 612.49)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"r\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 .15435 .00897 .31646 970.76 250.51)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"s\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73092 .00801 -.05464 .31184 1010.7 281.9)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"t\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 989.98 251.77)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"u\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 995.87 238.35)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"v\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73086 -.01204 -.05293 -.31214 1017.3 570.96)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><radialGradient id=\"w\" gradientUnits=\"userSpaceOnUse\" cy=\"133.61\" cx=\"14.817\" gradientTransform=\"matrix(2.8644 0 0 2.343 738.15 127.24)\" r=\"40.913\"><stop stop-color=\"#f6f6aa\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#f8f8ac\" offset=\"1\"></stop></radialGradient></defs><path d=\"M335.11 255.73l663.28-80.86L334.34 291.5z\" transform=\"matrix(.68228 0 0 -1.2055 -212.275 413)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#c)\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -287.17)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -274.9)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -260.97)\" stroke=\"#000\" stroke-width=\"1.266\"></path><path d=\"M477.98 260.36L442.8 755.71l71.61 11.07 8.39-516.6z\" fill=\"#b3b3b3\" stroke=\"#b3b3b3\"></path><path d=\"M522.98 250.36l40.714 6.429 27.143 503.57-76.071 7.142z\" fill=\"#f2f2f2\" stroke=\"#f2f2f2\"></path><path d=\"M563.69 256.78l20 12.857 41.071 481.07-33.75 9.464z\" fill=\"#ececec\" stroke=\"#ececec\"></path><path d=\"M468.69 270.36l9.286-8.571-35.536 493.93-19.464-8.215z\" fill=\"#999\" stroke=\"#b3b3b3\"></path><path d=\"M536.9 494.32l26.895.126-1.515 55.432z\" fill=\"#b3b3b3\"></path><path d=\"M540.92 500.13l17.425.253.126 18.562-17.678-.127zm.05 20.93l17.425.253.126 18.562-17.678-.127zm-97.89 131.1l1.515-49.119 4.672-1.768-3.283 51.644zm15.59-199.06l1.515-49.119 4.672-1.768-3.283 51.644zm9.85-125.26l1.515-49.119 4.672-1.768-3.283 51.644z\" stroke=\"#000\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -299.45)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M567.349 188.699a41.786 13.304 0 1 1-.004-.183\"></path><path d=\"M297.95 302.54c17.309-10.51 57.09-7.151 72.143.536v-25.18c-21.019-12.346-47.757-13.053-71.786-1.606z\" fill=\"url(#d)\" stroke=\"#000\" stroke-width=\"2.2\" transform=\"translate(191.55 -84.15)\"></path><path d=\"M485.03 248.35c17.309-10.51 66.019-8.937 81.071-1.25v-25.179c-18.16-11.63-58.11-14.3-80.71-1.6z\" stroke=\"#000\"></path><path d=\"M513.07 160.21l13.036-10.714 11.964 11.071z\" stroke=\"#000\" stroke-linejoin=\"round\"></path><path d=\"M516.91 160l.357 16.071 16.43.536.535-16.25z\" stroke=\"#000\"></path><path d=\"M525.84 152.86l.893-55.179M477.09 210.18l.536 34.107M462.26 224.64l.54 34.11m125.18-37.5l-.536 37.679M565.84 207.68l-.714 38.214\" fill=\"none\" stroke=\"#000\"></path><path d=\"M538.985 160.537a13.181 4.197 0 1 1-.001-.057\"></path><path d=\"M557.73 191.91l-6.566 22.728m-7.074-1.518l-6.06-26.264\" fill=\"none\" stroke=\"#000\" stroke-width=\"2.3\"></path><path d=\"M1013.6 197.14l-658.29 84.542v14.496s662.99 98.569 658.29 93.904z\" transform=\"matrix(-.68228 0 0 1.1507 711.32 -134.302)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#e)\"></path><path d=\"M286.77 301.95l439.86 97.468v17.688l-439.86 114.58z\" opacity=\".668\" fill=\"url(#f)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1012.9 190.92l-657.59 94.611v5.7s660.74 108.96 656.04 104.29z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#g)\"></path><path d=\"M281.44 345.28l445.18 59.875v6.424l-450.25-1.9z\" opacity=\".668\" fill=\"url(#h)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M265.33 331.8l461.3 91.787v-4.588l-459.59-146.78z\" opacity=\".49\" fill=\"url(#i)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M360.24 384.45l637.23-203.31-628.3 233.59z\" transform=\"matrix(.6533 -.34756 -.19671 -1.1543 -147.12 760.92)\" opacity=\".363\" fill=\"#80ffe6\" filter=\"url(#c)\"></path><path d=\"M269.5 490.25l457.12-78.122v-4.55L266 435.896z\" opacity=\".668\" fill=\"url(#j)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1015.4 297.01l-660.09-11.053v3.268l657.64 50.226z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#k)\"></path><path d=\"M281.24 466.99l445.38-46.915v-4.493l-452.31-6.95z\" opacity=\".413\" fill=\"url(#l)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M335.11 255.73l690.19-66.12L334.34 291.5z\" transform=\"matrix(.655 -.00473 -.00882 -1.0965 -201.033 430.01)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#m)\"></path><path d=\"M1021.2 227.46l-692.97 45.145.044 3.267 690.48-5.972z\" transform=\"matrix(-.655 .00473 .00893 1.1099 681.49 -92.81)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#n)\"></path><path d=\"M281.22 385.8l445.4 37.255v5.846l-449.81 15.513z\" opacity=\".668\" fill=\"url(#o)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M281.2 403.46l445.42 22.099v-2.652l-449.18-68.864z\" opacity=\".668\" fill=\"url(#p)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M268.46 392.63l458.17 32.063v-4.174l-456.96-82.1z\" opacity=\".49\" fill=\"url(#q)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M261.2 515.57l465.42-87.279v4.588l-463.71 142.27z\" opacity=\".49\" fill=\"url(#r)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M262.43 391.94l464.19 27.007v4.52L267 453.625z\" opacity=\".49\" fill=\"url(#s)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M260.94 457.27l465.68-29.23v4.583l-468.9 84.168z\" opacity=\".49\" fill=\"url(#t)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M266.84 443.85l459.78-22.943v4.583l-463.01 77.881z\" opacity=\".49\" fill=\"url(#u)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M269.64 449.38l456.98-17.832v-4.525l-466.93-36.415z\" opacity=\".49\" fill=\"url(#v)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M897.77 440.28c0 52.925-52.449 95.838-117.16 95.854-64.709 0-117.18-42.881-117.22-95.822-.032-52.925 52.392-95.857 117.1-95.897 64.709-.04 117.21 42.828 117.28 95.753\" opacity=\".875\" fill=\"url(#w)\" transform=\"translate(-257.72 -210.44)\"></path></svg><p class=\"loss_title\">搜索关键词不能为空</p><p class=\"loss_detail\">输入关键词以搜索</p></div>";
        }else if($html==""){
            $k4 = rawurldecode($key);
            $html = "<div style=\"position:relative;width:auto;margin:0px auto;padding:80px 0;text-align:center\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"128\" height=\"96\" viewBox=\"0 0 1024 768\"><defs><linearGradient id=\"b\" x1=\"162.84\" gradientUnits=\"userSpaceOnUse\" x2=\"162.84\" gradientTransform=\"matrix(.70233 0 0 .6756 -3.924 6.49)\" y1=\"439.45\" y2=\"228.35\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><filter id=\"g\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"2.186\"></feGaussianBlur></filter><filter id=\"e\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.5\"></feGaussianBlur></filter><filter id=\"k\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"c\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"a\"><stop stop-color=\"#fff\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fff\" offset=\"1\"></stop></linearGradient><filter id=\"n\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"m\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"d\" y2=\"285.22\" gradientUnits=\"userSpaceOnUse\" x2=\"360.36\" y1=\"283.79\" x1=\"342.5\"><stop offset=\"0\"></stop><stop stop-color=\"#ccc\" offset=\"1\"></stop></linearGradient><linearGradient id=\"f\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68228 0 0 1.2202 967.34 -126.44)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"h\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.70022 -.06541 -.01782 .44318 984.41 235.89)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"i\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 -.15435 .00897 -.31646 979.33 599.82)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"j\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71803 .08687 -.02422 -.31389 995.29 518.54)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"l\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71264 .17918 -.0368 -.30996 999.11 486.13)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"o\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.67271 -.05464 -.01387 .40326 955.28 281.41)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"p\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68869 .084 -.02555 -.28535 967.79 538.45)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"q\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68705 -.13544 .0063 -.28793 953.07 612.49)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"r\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 .15435 .00897 .31646 970.76 250.51)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"s\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73092 .00801 -.05464 .31184 1010.7 281.9)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"t\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 989.98 251.77)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"u\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 995.87 238.35)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"v\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73086 -.01204 -.05293 -.31214 1017.3 570.96)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><radialGradient id=\"w\" gradientUnits=\"userSpaceOnUse\" cy=\"133.61\" cx=\"14.817\" gradientTransform=\"matrix(2.8644 0 0 2.343 738.15 127.24)\" r=\"40.913\"><stop stop-color=\"#f6f6aa\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#f8f8ac\" offset=\"1\"></stop></radialGradient></defs><path d=\"M335.11 255.73l663.28-80.86L334.34 291.5z\" transform=\"matrix(.68228 0 0 -1.2055 -212.275 413)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#c)\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -287.17)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -274.9)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -260.97)\" stroke=\"#000\" stroke-width=\"1.266\"></path><path d=\"M477.98 260.36L442.8 755.71l71.61 11.07 8.39-516.6z\" fill=\"#b3b3b3\" stroke=\"#b3b3b3\"></path><path d=\"M522.98 250.36l40.714 6.429 27.143 503.57-76.071 7.142z\" fill=\"#f2f2f2\" stroke=\"#f2f2f2\"></path><path d=\"M563.69 256.78l20 12.857 41.071 481.07-33.75 9.464z\" fill=\"#ececec\" stroke=\"#ececec\"></path><path d=\"M468.69 270.36l9.286-8.571-35.536 493.93-19.464-8.215z\" fill=\"#999\" stroke=\"#b3b3b3\"></path><path d=\"M536.9 494.32l26.895.126-1.515 55.432z\" fill=\"#b3b3b3\"></path><path d=\"M540.92 500.13l17.425.253.126 18.562-17.678-.127zm.05 20.93l17.425.253.126 18.562-17.678-.127zm-97.89 131.1l1.515-49.119 4.672-1.768-3.283 51.644zm15.59-199.06l1.515-49.119 4.672-1.768-3.283 51.644zm9.85-125.26l1.515-49.119 4.672-1.768-3.283 51.644z\" stroke=\"#000\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -299.45)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M567.349 188.699a41.786 13.304 0 1 1-.004-.183\"></path><path d=\"M297.95 302.54c17.309-10.51 57.09-7.151 72.143.536v-25.18c-21.019-12.346-47.757-13.053-71.786-1.606z\" fill=\"url(#d)\" stroke=\"#000\" stroke-width=\"2.2\" transform=\"translate(191.55 -84.15)\"></path><path d=\"M485.03 248.35c17.309-10.51 66.019-8.937 81.071-1.25v-25.179c-18.16-11.63-58.11-14.3-80.71-1.6z\" stroke=\"#000\"></path><path d=\"M513.07 160.21l13.036-10.714 11.964 11.071z\" stroke=\"#000\" stroke-linejoin=\"round\"></path><path d=\"M516.91 160l.357 16.071 16.43.536.535-16.25z\" stroke=\"#000\"></path><path d=\"M525.84 152.86l.893-55.179M477.09 210.18l.536 34.107M462.26 224.64l.54 34.11m125.18-37.5l-.536 37.679M565.84 207.68l-.714 38.214\" fill=\"none\" stroke=\"#000\"></path><path d=\"M538.985 160.537a13.181 4.197 0 1 1-.001-.057\"></path><path d=\"M557.73 191.91l-6.566 22.728m-7.074-1.518l-6.06-26.264\" fill=\"none\" stroke=\"#000\" stroke-width=\"2.3\"></path><path d=\"M1013.6 197.14l-658.29 84.542v14.496s662.99 98.569 658.29 93.904z\" transform=\"matrix(-.68228 0 0 1.1507 711.32 -134.302)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#e)\"></path><path d=\"M286.77 301.95l439.86 97.468v17.688l-439.86 114.58z\" opacity=\".668\" fill=\"url(#f)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1012.9 190.92l-657.59 94.611v5.7s660.74 108.96 656.04 104.29z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#g)\"></path><path d=\"M281.44 345.28l445.18 59.875v6.424l-450.25-1.9z\" opacity=\".668\" fill=\"url(#h)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M265.33 331.8l461.3 91.787v-4.588l-459.59-146.78z\" opacity=\".49\" fill=\"url(#i)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M360.24 384.45l637.23-203.31-628.3 233.59z\" transform=\"matrix(.6533 -.34756 -.19671 -1.1543 -147.12 760.92)\" opacity=\".363\" fill=\"#80ffe6\" filter=\"url(#c)\"></path><path d=\"M269.5 490.25l457.12-78.122v-4.55L266 435.896z\" opacity=\".668\" fill=\"url(#j)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1015.4 297.01l-660.09-11.053v3.268l657.64 50.226z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#k)\"></path><path d=\"M281.24 466.99l445.38-46.915v-4.493l-452.31-6.95z\" opacity=\".413\" fill=\"url(#l)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M335.11 255.73l690.19-66.12L334.34 291.5z\" transform=\"matrix(.655 -.00473 -.00882 -1.0965 -201.033 430.01)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#m)\"></path><path d=\"M1021.2 227.46l-692.97 45.145.044 3.267 690.48-5.972z\" transform=\"matrix(-.655 .00473 .00893 1.1099 681.49 -92.81)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#n)\"></path><path d=\"M281.22 385.8l445.4 37.255v5.846l-449.81 15.513z\" opacity=\".668\" fill=\"url(#o)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M281.2 403.46l445.42 22.099v-2.652l-449.18-68.864z\" opacity=\".668\" fill=\"url(#p)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M268.46 392.63l458.17 32.063v-4.174l-456.96-82.1z\" opacity=\".49\" fill=\"url(#q)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M261.2 515.57l465.42-87.279v4.588l-463.71 142.27z\" opacity=\".49\" fill=\"url(#r)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M262.43 391.94l464.19 27.007v4.52L267 453.625z\" opacity=\".49\" fill=\"url(#s)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M260.94 457.27l465.68-29.23v4.583l-468.9 84.168z\" opacity=\".49\" fill=\"url(#t)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M266.84 443.85l459.78-22.943v4.583l-463.01 77.881z\" opacity=\".49\" fill=\"url(#u)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M269.64 449.38l456.98-17.832v-4.525l-466.93-36.415z\" opacity=\".49\" fill=\"url(#v)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M897.77 440.28c0 52.925-52.449 95.838-117.16 95.854-64.709 0-117.18-42.881-117.22-95.822-.032-52.925 52.392-95.857 117.1-95.897 64.709-.04 117.21 42.828 117.28 95.753\" opacity=\".875\" fill=\"url(#w)\" transform=\"translate(-257.72 -210.44)\"></path></svg><p class=\"loss_title\">没有任何包含此标签的书或标签号有误</p><p class=\"loss_detail\">我们的书库里没有标有‘<b>$k4</b>’的书</p><p class=\"loss_detail\">您可以为我们的书库<a xhr href=\"?book/#edit\">添加标有‘<b>$k4</b>’的书</a></p><p class=\"loss_detail\">没有显示搜索结果？<a xhr href=\"?help/search\" style=\"color:#0366d6;\">帮助</a></p></div>";
        }
        return $html;
    }

    function getLabelidAListHtml($arr,$key){
        $html = "";
        for($i=0;$i<sizeof($arr);$i++){
            $id = $arr[$i]["bklid"];
            $picpath = isset(explode(":",$arr[$i]["picpath"])[0])?explode(":",$arr[$i]["picpath"])[0]:"";
            $names = rawurldecode($arr[$i]["names"]);
            $books = explode(":",urldecode($arr[$i]["bookid"]));
            $labels = explode(":",urldecode($arr[$i]["label"]));
            $contents = urldecode(textLimit2($arr[$i]["contents"],1200)) . "...";
            $datestr = date("Y年m月d日",$arr[$i]["date"]);
            $key = urldecode($key);
            if(isset($arr[$i]["ultra-lang"])) $names.= " (".rawurldecode($arr[$i]["ultra-lang"]).")";
            $type = "";
            if($picpath!=""){
                $type = "image";
            }else{
                $type = "text-only";
            }
            $html .= "<div class=\"infobox\" with='$type'>";
            if($picpath!="") $html .= "<a xhr href=\"?list/$id\"><img src=\"Image/list/$picpath\"></a>";
            $html .= '<div class="text">';
            $html .= "<a class=\"title\" xhr href=\"?list/$id\">$names</a>&nbsp;&nbsp;<span style='color:#54595d'>创建于$datestr</span>";
            $html .= "<p>$contents...</p>";
            $html .= '<p g="">#书单 | 包含书籍：';
            $c = 0;
            $c1 = 0;
            for($x=0;$x<sizeof($books);$x++){
                $bookid = $books[$x];
                $c++;
                if($c1>=3) continue;
                if(strpos($bookid,"id_")!==false){
                    $id = substr($bookid,3);
                    $res = exeSql("SELECT names FROM bokinfo WHERE bookid='$id'");
                    while($row = mysqli_fetch_array($res,MYSQLI_ASSOC)){
                        #change the number to modify limitation of books
                        $name = urldecode($row["names"]);
                        $html .= "<a xhr href=\"?book/$id\">$name</a>";
                        $break;
                    }
                }else{
                    $bookid = urldecode($bookid);
                    $html .= "<a>$bookid</a>";
                }
                if($x!==sizeof($books)-1){
                    $html .= "，";
                }
                $c1++;
            }
            if($c1<$c){
                $html .= "以及更多";
            }
            if(sizeof($labels)!=0&&$labels[0]!=""){
                $html .= "&nbsp;|&nbsp标签：";
            }
            for($x=0;$x<sizeof($labels);$x++){
                $labelid = $labels[$x];
                if(strpos($labelid,"id_")!==false){
                    $id = substr($labelid,3);
                    $res = exeSql("SELECT label_name FROM lblinfo WHERE labelid='$id'");
                    while($row = mysqli_fetch_array($res,MYSQLI_ASSOC)){
                        $name = urldecode($row["label_name"]);
                        $html .= "<a xhr href=\"?search/labelid/$id\">$name</a>";
                    }
                }else{
                    $labelid = urldecode($labelid);
                    $html .= "<a>$labelid</a>";
                }
                if($x!==sizeof($labels)-1){
                    $html .= "，";
                }
            }
            $html .= "</p>";
            $html .= '</div></div>';
        }
        if($key==""){
            $html = "<div style=\"position:relative;width:auto;margin:0px auto;padding:80px 0;text-align:center\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"128\" height=\"96\" viewBox=\"0 0 1024 768\"><defs><linearGradient id=\"b\" x1=\"162.84\" gradientUnits=\"userSpaceOnUse\" x2=\"162.84\" gradientTransform=\"matrix(.70233 0 0 .6756 -3.924 6.49)\" y1=\"439.45\" y2=\"228.35\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><filter id=\"g\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"2.186\"></feGaussianBlur></filter><filter id=\"e\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.5\"></feGaussianBlur></filter><filter id=\"k\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"c\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"a\"><stop stop-color=\"#fff\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fff\" offset=\"1\"></stop></linearGradient><filter id=\"n\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"m\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"d\" y2=\"285.22\" gradientUnits=\"userSpaceOnUse\" x2=\"360.36\" y1=\"283.79\" x1=\"342.5\"><stop offset=\"0\"></stop><stop stop-color=\"#ccc\" offset=\"1\"></stop></linearGradient><linearGradient id=\"f\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68228 0 0 1.2202 967.34 -126.44)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"h\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.70022 -.06541 -.01782 .44318 984.41 235.89)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"i\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 -.15435 .00897 -.31646 979.33 599.82)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"j\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71803 .08687 -.02422 -.31389 995.29 518.54)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"l\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71264 .17918 -.0368 -.30996 999.11 486.13)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"o\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.67271 -.05464 -.01387 .40326 955.28 281.41)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"p\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68869 .084 -.02555 -.28535 967.79 538.45)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"q\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68705 -.13544 .0063 -.28793 953.07 612.49)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"r\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 .15435 .00897 .31646 970.76 250.51)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"s\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73092 .00801 -.05464 .31184 1010.7 281.9)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"t\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 989.98 251.77)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"u\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 995.87 238.35)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"v\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73086 -.01204 -.05293 -.31214 1017.3 570.96)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><radialGradient id=\"w\" gradientUnits=\"userSpaceOnUse\" cy=\"133.61\" cx=\"14.817\" gradientTransform=\"matrix(2.8644 0 0 2.343 738.15 127.24)\" r=\"40.913\"><stop stop-color=\"#f6f6aa\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#f8f8ac\" offset=\"1\"></stop></radialGradient></defs><path d=\"M335.11 255.73l663.28-80.86L334.34 291.5z\" transform=\"matrix(.68228 0 0 -1.2055 -212.275 413)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#c)\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -287.17)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -274.9)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -260.97)\" stroke=\"#000\" stroke-width=\"1.266\"></path><path d=\"M477.98 260.36L442.8 755.71l71.61 11.07 8.39-516.6z\" fill=\"#b3b3b3\" stroke=\"#b3b3b3\"></path><path d=\"M522.98 250.36l40.714 6.429 27.143 503.57-76.071 7.142z\" fill=\"#f2f2f2\" stroke=\"#f2f2f2\"></path><path d=\"M563.69 256.78l20 12.857 41.071 481.07-33.75 9.464z\" fill=\"#ececec\" stroke=\"#ececec\"></path><path d=\"M468.69 270.36l9.286-8.571-35.536 493.93-19.464-8.215z\" fill=\"#999\" stroke=\"#b3b3b3\"></path><path d=\"M536.9 494.32l26.895.126-1.515 55.432z\" fill=\"#b3b3b3\"></path><path d=\"M540.92 500.13l17.425.253.126 18.562-17.678-.127zm.05 20.93l17.425.253.126 18.562-17.678-.127zm-97.89 131.1l1.515-49.119 4.672-1.768-3.283 51.644zm15.59-199.06l1.515-49.119 4.672-1.768-3.283 51.644zm9.85-125.26l1.515-49.119 4.672-1.768-3.283 51.644z\" stroke=\"#000\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -299.45)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M567.349 188.699a41.786 13.304 0 1 1-.004-.183\"></path><path d=\"M297.95 302.54c17.309-10.51 57.09-7.151 72.143.536v-25.18c-21.019-12.346-47.757-13.053-71.786-1.606z\" fill=\"url(#d)\" stroke=\"#000\" stroke-width=\"2.2\" transform=\"translate(191.55 -84.15)\"></path><path d=\"M485.03 248.35c17.309-10.51 66.019-8.937 81.071-1.25v-25.179c-18.16-11.63-58.11-14.3-80.71-1.6z\" stroke=\"#000\"></path><path d=\"M513.07 160.21l13.036-10.714 11.964 11.071z\" stroke=\"#000\" stroke-linejoin=\"round\"></path><path d=\"M516.91 160l.357 16.071 16.43.536.535-16.25z\" stroke=\"#000\"></path><path d=\"M525.84 152.86l.893-55.179M477.09 210.18l.536 34.107M462.26 224.64l.54 34.11m125.18-37.5l-.536 37.679M565.84 207.68l-.714 38.214\" fill=\"none\" stroke=\"#000\"></path><path d=\"M538.985 160.537a13.181 4.197 0 1 1-.001-.057\"></path><path d=\"M557.73 191.91l-6.566 22.728m-7.074-1.518l-6.06-26.264\" fill=\"none\" stroke=\"#000\" stroke-width=\"2.3\"></path><path d=\"M1013.6 197.14l-658.29 84.542v14.496s662.99 98.569 658.29 93.904z\" transform=\"matrix(-.68228 0 0 1.1507 711.32 -134.302)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#e)\"></path><path d=\"M286.77 301.95l439.86 97.468v17.688l-439.86 114.58z\" opacity=\".668\" fill=\"url(#f)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1012.9 190.92l-657.59 94.611v5.7s660.74 108.96 656.04 104.29z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#g)\"></path><path d=\"M281.44 345.28l445.18 59.875v6.424l-450.25-1.9z\" opacity=\".668\" fill=\"url(#h)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M265.33 331.8l461.3 91.787v-4.588l-459.59-146.78z\" opacity=\".49\" fill=\"url(#i)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M360.24 384.45l637.23-203.31-628.3 233.59z\" transform=\"matrix(.6533 -.34756 -.19671 -1.1543 -147.12 760.92)\" opacity=\".363\" fill=\"#80ffe6\" filter=\"url(#c)\"></path><path d=\"M269.5 490.25l457.12-78.122v-4.55L266 435.896z\" opacity=\".668\" fill=\"url(#j)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1015.4 297.01l-660.09-11.053v3.268l657.64 50.226z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#k)\"></path><path d=\"M281.24 466.99l445.38-46.915v-4.493l-452.31-6.95z\" opacity=\".413\" fill=\"url(#l)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M335.11 255.73l690.19-66.12L334.34 291.5z\" transform=\"matrix(.655 -.00473 -.00882 -1.0965 -201.033 430.01)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#m)\"></path><path d=\"M1021.2 227.46l-692.97 45.145.044 3.267 690.48-5.972z\" transform=\"matrix(-.655 .00473 .00893 1.1099 681.49 -92.81)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#n)\"></path><path d=\"M281.22 385.8l445.4 37.255v5.846l-449.81 15.513z\" opacity=\".668\" fill=\"url(#o)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M281.2 403.46l445.42 22.099v-2.652l-449.18-68.864z\" opacity=\".668\" fill=\"url(#p)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M268.46 392.63l458.17 32.063v-4.174l-456.96-82.1z\" opacity=\".49\" fill=\"url(#q)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M261.2 515.57l465.42-87.279v4.588l-463.71 142.27z\" opacity=\".49\" fill=\"url(#r)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M262.43 391.94l464.19 27.007v4.52L267 453.625z\" opacity=\".49\" fill=\"url(#s)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M260.94 457.27l465.68-29.23v4.583l-468.9 84.168z\" opacity=\".49\" fill=\"url(#t)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M266.84 443.85l459.78-22.943v4.583l-463.01 77.881z\" opacity=\".49\" fill=\"url(#u)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M269.64 449.38l456.98-17.832v-4.525l-466.93-36.415z\" opacity=\".49\" fill=\"url(#v)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M897.77 440.28c0 52.925-52.449 95.838-117.16 95.854-64.709 0-117.18-42.881-117.22-95.822-.032-52.925 52.392-95.857 117.1-95.897 64.709-.04 117.21 42.828 117.28 95.753\" opacity=\".875\" fill=\"url(#w)\" transform=\"translate(-257.72 -210.44)\"></path></svg><p class=\"loss_title\">搜索关键词不能为空</p><p class=\"loss_detail\">输入关键词以搜索</p></div>";
        }else if($html==""){
            $k4 = rawurldecode($key);
            $html = "<div style=\"position:relative;width:auto;margin:0px auto;padding:80px 0;text-align:center\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"128\" height=\"96\" viewBox=\"0 0 1024 768\"><defs><linearGradient id=\"b\" x1=\"162.84\" gradientUnits=\"userSpaceOnUse\" x2=\"162.84\" gradientTransform=\"matrix(.70233 0 0 .6756 -3.924 6.49)\" y1=\"439.45\" y2=\"228.35\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><filter id=\"g\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"2.186\"></feGaussianBlur></filter><filter id=\"e\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.5\"></feGaussianBlur></filter><filter id=\"k\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"c\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"a\"><stop stop-color=\"#fff\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fff\" offset=\"1\"></stop></linearGradient><filter id=\"n\" width=\"1.026\" y=\"-.165\" x=\"-.013\" height=\"1.331\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"3.687\"></feGaussianBlur></filter><filter id=\"m\" width=\"1.033\" y=\"-.104\" x=\"-.016\" height=\"1.209\" color-interpolation-filters=\"sRGB\"><feGaussianBlur stdDeviation=\"4.062\"></feGaussianBlur></filter><linearGradient id=\"d\" y2=\"285.22\" gradientUnits=\"userSpaceOnUse\" x2=\"360.36\" y1=\"283.79\" x1=\"342.5\"><stop offset=\"0\"></stop><stop stop-color=\"#ccc\" offset=\"1\"></stop></linearGradient><linearGradient id=\"f\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68228 0 0 1.2202 967.34 -126.44)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"h\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.70022 -.06541 -.01782 .44318 984.41 235.89)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"i\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 -.15435 .00897 -.31646 979.33 599.82)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"j\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71803 .08687 -.02422 -.31389 995.29 518.54)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"l\" y2=\"445.22\" xlink:href=\"#b\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71264 .17918 -.0368 -.30996 999.11 486.13)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"o\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.67271 -.05464 -.01387 .40326 955.28 281.41)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"p\" y2=\"445.22\" xlink:href=\"#a\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68869 .084 -.02555 -.28535 967.79 538.45)\" y1=\"445.22\" x1=\"564.42\"></linearGradient><linearGradient id=\"q\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.68705 -.13544 .0063 -.28793 953.07 612.49)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"r\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.71448 .15435 .00897 .31646 970.76 250.51)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"s\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73092 .00801 -.05464 .31184 1010.7 281.9)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"t\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 989.98 251.77)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"u\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.72479 .09476 -.01722 .31612 995.87 238.35)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#ffee58\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><linearGradient id=\"v\" y2=\"445.22\" gradientUnits=\"userSpaceOnUse\" x2=\"1188.2\" gradientTransform=\"matrix(-.73086 -.01204 -.05293 -.31214 1017.3 570.96)\" y1=\"445.22\" x1=\"564.42\"><stop stop-color=\"#fdd835\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#fdd835\" offset=\"1\"></stop></linearGradient><radialGradient id=\"w\" gradientUnits=\"userSpaceOnUse\" cy=\"133.61\" cx=\"14.817\" gradientTransform=\"matrix(2.8644 0 0 2.343 738.15 127.24)\" r=\"40.913\"><stop stop-color=\"#f6f6aa\" offset=\"0\"></stop><stop stop-opacity=\"0\" stop-color=\"#f8f8ac\" offset=\"1\"></stop></radialGradient></defs><path d=\"M335.11 255.73l663.28-80.86L334.34 291.5z\" transform=\"matrix(.68228 0 0 -1.2055 -212.275 413)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#c)\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -287.17)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -274.9)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -260.97)\" stroke=\"#000\" stroke-width=\"1.266\"></path><path d=\"M477.98 260.36L442.8 755.71l71.61 11.07 8.39-516.6z\" fill=\"#b3b3b3\" stroke=\"#b3b3b3\"></path><path d=\"M522.98 250.36l40.714 6.429 27.143 503.57-76.071 7.142z\" fill=\"#f2f2f2\" stroke=\"#f2f2f2\"></path><path d=\"M563.69 256.78l20 12.857 41.071 481.07-33.75 9.464z\" fill=\"#ececec\" stroke=\"#ececec\"></path><path d=\"M468.69 270.36l9.286-8.571-35.536 493.93-19.464-8.215z\" fill=\"#999\" stroke=\"#b3b3b3\"></path><path d=\"M536.9 494.32l26.895.126-1.515 55.432z\" fill=\"#b3b3b3\"></path><path d=\"M540.92 500.13l17.425.253.126 18.562-17.678-.127zm.05 20.93l17.425.253.126 18.562-17.678-.127zm-97.89 131.1l1.515-49.119 4.672-1.768-3.283 51.644zm15.59-199.06l1.515-49.119 4.672-1.768-3.283 51.644zm9.85-125.26l1.515-49.119 4.672-1.768-3.283 51.644z\" stroke=\"#000\"></path><path d=\"M396.25 308.52a66.875 12.589 0 1 1-.006-.173\" transform=\"matrix(.94034 0 0 1.6973 215.844 -299.45)\" fill=\"none\" stroke=\"#000\" stroke-width=\".792\"></path><path d=\"M567.349 188.699a41.786 13.304 0 1 1-.004-.183\"></path><path d=\"M297.95 302.54c17.309-10.51 57.09-7.151 72.143.536v-25.18c-21.019-12.346-47.757-13.053-71.786-1.606z\" fill=\"url(#d)\" stroke=\"#000\" stroke-width=\"2.2\" transform=\"translate(191.55 -84.15)\"></path><path d=\"M485.03 248.35c17.309-10.51 66.019-8.937 81.071-1.25v-25.179c-18.16-11.63-58.11-14.3-80.71-1.6z\" stroke=\"#000\"></path><path d=\"M513.07 160.21l13.036-10.714 11.964 11.071z\" stroke=\"#000\" stroke-linejoin=\"round\"></path><path d=\"M516.91 160l.357 16.071 16.43.536.535-16.25z\" stroke=\"#000\"></path><path d=\"M525.84 152.86l.893-55.179M477.09 210.18l.536 34.107M462.26 224.64l.54 34.11m125.18-37.5l-.536 37.679M565.84 207.68l-.714 38.214\" fill=\"none\" stroke=\"#000\"></path><path d=\"M538.985 160.537a13.181 4.197 0 1 1-.001-.057\"></path><path d=\"M557.73 191.91l-6.566 22.728m-7.074-1.518l-6.06-26.264\" fill=\"none\" stroke=\"#000\" stroke-width=\"2.3\"></path><path d=\"M1013.6 197.14l-658.29 84.542v14.496s662.99 98.569 658.29 93.904z\" transform=\"matrix(-.68228 0 0 1.1507 711.32 -134.302)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#e)\"></path><path d=\"M286.77 301.95l439.86 97.468v17.688l-439.86 114.58z\" opacity=\".668\" fill=\"url(#f)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1012.9 190.92l-657.59 94.611v5.7s660.74 108.96 656.04 104.29z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".668\" fill=\"none\" stroke=\"#fff\" stroke-width=\"4.048\" filter=\"url(#g)\"></path><path d=\"M281.44 345.28l445.18 59.875v6.424l-450.25-1.9z\" opacity=\".668\" fill=\"url(#h)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M265.33 331.8l461.3 91.787v-4.588l-459.59-146.78z\" opacity=\".49\" fill=\"url(#i)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M360.24 384.45l637.23-203.31-628.3 233.59z\" transform=\"matrix(.6533 -.34756 -.19671 -1.1543 -147.12 760.92)\" opacity=\".363\" fill=\"#80ffe6\" filter=\"url(#c)\"></path><path d=\"M269.5 490.25l457.12-78.122v-4.55L266 435.896z\" opacity=\".668\" fill=\"url(#j)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M1015.4 297.01l-660.09-11.053v3.268l657.64 50.226z\" transform=\"matrix(-.68228 0 0 1.2202 711.32 -154.728)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#k)\"></path><path d=\"M281.24 466.99l445.38-46.915v-4.493l-452.31-6.95z\" opacity=\".413\" fill=\"url(#l)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M335.11 255.73l690.19-66.12L334.34 291.5z\" transform=\"matrix(.655 -.00473 -.00882 -1.0965 -201.033 430.01)\" opacity=\".363\" fill=\"#ffee58\" filter=\"url(#m)\"></path><path d=\"M1021.2 227.46l-692.97 45.145.044 3.267 690.48-5.972z\" transform=\"matrix(-.655 .00473 .00893 1.1099 681.49 -92.81)\" opacity=\".313\" fill=\"#fff\" filter=\"url(#n)\"></path><path d=\"M281.22 385.8l445.4 37.255v5.846l-449.81 15.513z\" opacity=\".668\" fill=\"url(#o)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M281.2 403.46l445.42 22.099v-2.652l-449.18-68.864z\" opacity=\".668\" fill=\"url(#p)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M268.46 392.63l458.17 32.063v-4.174l-456.96-82.1z\" opacity=\".49\" fill=\"url(#q)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M261.2 515.57l465.42-87.279v4.588l-463.71 142.27z\" opacity=\".49\" fill=\"url(#r)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M262.43 391.94l464.19 27.007v4.52L267 453.625z\" opacity=\".49\" fill=\"url(#s)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M260.94 457.27l465.68-29.23v4.583l-468.9 84.168z\" opacity=\".49\" fill=\"url(#t)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M266.84 443.85l459.78-22.943v4.583l-463.01 77.881z\" opacity=\".49\" fill=\"url(#u)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M269.64 449.38l456.98-17.832v-4.525l-466.93-36.415z\" opacity=\".49\" fill=\"url(#v)\" transform=\"translate(-257.72 -210.44)\"></path><path d=\"M897.77 440.28c0 52.925-52.449 95.838-117.16 95.854-64.709 0-117.18-42.881-117.22-95.822-.032-52.925 52.392-95.857 117.1-95.897 64.709-.04 117.21 42.828 117.28 95.753\" opacity=\".875\" fill=\"url(#w)\" transform=\"translate(-257.72 -210.44)\"></path></svg><p class=\"loss_title\">没有任何包含此标签的书单或标签号有误</p><p class=\"loss_detail\">我们的资料库里没有标有‘<b>$k4</b>’的书单</p><p class=\"loss_detail\">您可以为我们的资料库<a xhr href=\"?list/#edit\">添加标有‘<b>$k4</b>’的书单</a></p><p class=\"loss_detail\">没有显示搜索结果？<a xhr href=\"?help/search\" style=\"color:#0366d6;\">帮助</a></p></div>";
        }
        return $html;
    }

    function getAllLabelHtml(){
        $html = "<ul label>";
        $res = exeSql("SELECT * FROM lblinfo");
        $count = 0;
        while($row=mysqli_fetch_array($res,MYSQLI_ASSOC)){
            $id = $row["labelid"];
            $name = $row["label_name"];
            $html .= "<li><a label xhr href=\"?search/labelid/$id\">$name</a></li>";
            $count++;
        }
        if($count==0) $html .= "<li>没有可用标签</li>";
        return $html . "</ul>";
    }

    function imLimit($arr,$lim_a,$lim_b){
        //limitation implementation
        $lim = array();
        if($lim_b==-1) $lim_b = sizeof($arr)-1;
        for($i=$lim_a;$i<=$lim_b;$i++){
            array_push($lim,$arr[$i]);
        }
        return $lim;
    }

    function textLimit2($text,$lim){
        while(mb_substr($text,$lim,1)!="%"&&$lim%9!=0&&$lim<mb_strlen($text)){
            $lim++;
        }
        return mb_substr($text,0,$lim);
    }

    function textLimit($text, $limit) {
        if (str_word_count($text, 0) > $limit) {
            $words = str_word_count($text, 2);
            $pos   = array_keys($words);
            $text  = substr($text, 0, $pos[$limit]);
        }
        return $text;
    }

    function writeSearch($searchkey,$page,$type){
        $page_range = SINDEX;
        $page_start = 0;
        $page_start_html = "";
        $page_end = 0;
        $page_end_html = "";
        $range = "";
        $key = rawurlencode($searchkey);
        $kw = "";
        $page = is_numeric($page)?(int)$page:0;
        $html = "";
        $page_end_html = "<p class=\"res\"><b>";
        $listhtml = "";
        $mykey = "";
        $data = array();
        $count = 0;
        if($key=="label%2Fall"||$key=="label%2Fall%2F"){
            $range = "标签";
            $kw = "所有标签";
            $mykey = rawurldecode($kw);
            $kw = rawurlencode(trim($mykey));
            $count = 1;
        }else if(strpos($key,"list%2F")!==false){
            $range = "书单";
            $kw = substr($key,7);
            $mykey = rawurldecode($kw);
            $kw = rawurlencode(trim($mykey));
            $data = searchList($kw);
            $count = sizeof($data);
        }else if(strpos($key,"author%2F")!==false){
            $range = "作者";
            $kw = substr($key,9);
            $mykey = rawurldecode($kw);
            $kw = rawurlencode(trim($mykey));
            $data = searchAuthor($kw);
            $count = sizeof($data);
        }else if(strpos($key,"labelid%2F")!==false){
            $range = "标签索引";
            $kw = substr($key,10);
            $mykey = rawurldecode($kw);
            $kw = rawurlencode(trim($mykey));
            if($type=="list"){
                $range .= "-书单";
                $data = searchLabelidAList($kw);
                $count = sizeof($data);
            }else{
                $data = searchLabelid($kw);
                $count = sizeof($data);
            }
            $r = exeSql("SELECT label_name FROM lblinfo WHERE labelid='$mykey'");
            while($row=mysqli_fetch_array($r,MYSQLI_ASSOC)){
                $mykey = $row["label_name"];
                $kw = $mykey;
                break;
            }
        }else if(strpos($key,"help%2F")!==false){
            //search from help
        }else{
            //search from book
            //convert array to html list
            $range = "书籍";
            $kw = $key;
            $mykey = rawurldecode($kw);
            $kw = rawurlencode(trim($mykey));
            //split page
            $data = searchBook($kw);
            $count = sizeof($data);
            $aarr = searchAuthor($kw);
            if(sizeof($aarr)!=0){
                if($aarr[0]["rel"]>=SINDEX){
                    $aurdata = imLimit($aarr,0,0);
                    $html .= getAurHtml($aurdata,$kw);
                    $html .= "<div class=\"infobox\" style=\"margin:0 0 15px 0\"><p style=\"float: right;\"><a xhr href=\"?search/author/$kw\">搜索更多与\"$mykey\"相关的作者</a></p></div>";
                }
            }
            $aarr = searchList($kw);
            if(sizeof($aarr)!=0){
                if($aarr[0]["rel"]>=SINDEX){
                    $aurdata = imLimit($aarr,0,0);
                    $html .= getListHtml($aurdata,$kw);
                    $html .= "<div class=\"infobox\" style=\"margin:0 0 15px 0\"><p style=\"float: right;\"><a xhr href=\"?search/list/$kw\">搜索更多与\"$mykey\"相关的书单</a></p></div>";
                }
            }
        }
        if($page*$page_range>$count){
            $page = intval($count/$page_range);
        }
        if($page<0){
            $page = 0;
        }
        $page_start = $page*$page_range+1;
        $page_end = $page_range*($page+1);
        $ndata = $page_end<sizeof($data)?imLimit($data,$page_start-1,$page_end-1):imLimit($data,$page_start-1,-1);
        $nc = $count-$page_end>$page_range?$page_range:$count-$page_end;
        $pe = $page_end>$count?$count:$page_end;
        $page_end_html .= "$count</b> 的 <b>$page_start - $pe</b>个结果";
        $page_start_html = "<p style='float:right' class='res'><b>$count</b> 的 <b>$page_start - $pe</b>个结果";
        $hasStart = false;
        $ks = urldecode($key);
        if($page_start>$page_range){
            if(!$hasStart){
                $page_end_html .= " | 浏览";
                $hasStart = true;
            }
            $pre_page = $page-1;
            $page_end_html .= "<a xhr href=\"?search/$ks&page=$pre_page\">前$page_range 个</a>";
        }
        if($page_end<$count){
            if(!$hasStart){
                $page_end_html .= " | 浏览";
                $hasStart = true;
            }else{
                $page_end_html .= "或";
            }
            $next_page = $page+1;
            $page_end_html .= "<a xhr href=\"?search/$ks&page=$next_page\">后$nc 个</a>";
        }
        if($key=="label%2Fall"||$key=="label%2Fall%2F"){
            $html = getAllLabelHtml();
        }else if(strpos($key,"list%2F")!==false){
            $html = getListHtml($ndata,$kw);
        }else if(strpos($key,"author%2F")!==false){
            $html = getAurHtml($ndata,$kw);
        }else if(strpos($key,"labelid%2F")!==false){
            if($type=="list"){
                $html = getLabelidAListHtml($ndata,$kw);
            }else{
                $html = getLabelidHtml($ndata,$kw);
            }
        }else if(strpos($key,"help%2F")!==false){
            //search from help
        }else{
            $html .= getBokHtml($ndata,$kw);
            //display price later
        }
        $mkey = rawurldecode($mykey);
        if($mykey=="") $mkey = "(空)";
        echo <<<SEARCHPAGE
        <div class="dcon" style="margin-top: 15px;padding-bottom:0">
            <div class="innercon">
                <p style="width:70%;"><i>$range: 搜索"<b>$mykey</b>"的结果&nbsp;</i></p>$page_start_html
            </div>
            <div class="innercon">
                <div class="mleft">
                    $html
                </div>
                <div class="mright">
                    <div class="title"><p style="padding:1px 6px">相关搜索</p></div>
                    <div class="linkbox" with="image">
                        <div class="icon" style="background-image: url('Image/merchant/douban.ico');"></div>
                        <div class="text">
                            <a href="https://search.douban.com/book/subject_search?search_text=$mykey">前往豆瓣</a>
                            <p>在豆瓣中搜索"$mykey"</p>
                        </div>
                    </div>
                    <div class="linkbox" with="image">
                        <div class="icon" style="background-image: url('Image/merchant/goodreads.ico');"></div>
                        <div class="text">
                            <a href="https://www.goodreads.com/search?utf8=%E2%9C%93&q=$mykey">前往goodreads</a>
                            <p>在goodreads中搜索"$mykey"</p>
                        </div>
                    </div>
                    <div class="shadbox" style="margin-top:10px">
                        <div class="title"><p style="padding:1px 6px">找不到您想要的书籍，作者或书单？</p></div>
                        <div class="d">立即<a class="title" xhr href="?book#edit">录入书籍</a>、<a class="title" xhr href="?author#edit">录入作者</a>或<a class="title" xhr href="?list#edit">创建书单</a></div>
                    </div>
                    <div class="title"><p style="padding:1px 6px">高级选项</p></div>
                    <div class="linkbox" with="image">
                        <div class="icon" style="background-image: url('Image/fatcow/help.png');"></div>
                        <div class="text">
                            <a href="javascript:;" onclick="focusSearch('help:')">搜索帮助</a>
                            <p>搜索疑问关键词</p>
                        </div>
                    </div>
                    <div class="linkbox" with="image">
                        <div class="icon" style="background-image: url('Image/fatcow/exclamation.png');"></div>
                        <div class="text">
                            <a href="javascript:;" onclick="feedback()">反馈问题</a>
                            <p>将网站的错误报告给管理员</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="innercon" style="margin-bottom: 0;">
                $page_end_html | <a href="javascript:scrollTop();">返回顶部</a></p>
            </div>
            <p id="page_title">DeBook: 搜索$range'$mkey' </p>
        </div>
        SEARCHPAGE;
    }

    function doJsonSearch($action,$key){
        $key = rawurlencode($key);
        if($action=="book"){
            $p = array();
            $aur = searchAuthor($key);
            if(sizeof($aur)>0){
                if($aur[0]["rel"]>=SINDEX){
                    array_push($p,$aur[0]);
                }
            }
            $lst = searchList($key);
            if(sizeof($lst)>0){
                if($lst[0]["rel"]>=SINDEX){
                    array_push($p,$lst[0]);
                }
            }
            $bok = searchBook($key);
            for($i=0;$i<sizeof($bok);$i++){
                array_push($p,$bok[$i]);
            }
            echo json_encode($p);
        }else if($action=="author"){
            echo json_encode(searchAuthor($key));
        }else if($action=="list"){
            echo json_encode(searchList($key));
        }else if($action=="label"){
            echo json_encode(searchLabel($key));
        }else if($action=="help"){
            echo json_encode(searchHelp($key));
        }
    }

    if(!isset($home)){
        $cmd = getArray($_POST,"cmd");
        if($cmd=="xml"){
            doJsonSearch(getArray($_POST,"type"),getArray($_POST,"searchkey"));
        }else{
            writeSearch(getArray($_POST,"searchkey"),getArray($_POST,"page"),getArray($_POST,"type"));
        }
    }
?>